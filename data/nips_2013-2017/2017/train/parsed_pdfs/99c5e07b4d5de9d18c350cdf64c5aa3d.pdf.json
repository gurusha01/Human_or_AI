{
  "name" : "99c5e07b4d5de9d18c350cdf64c5aa3d.pdf",
  "metadata" : {
    "source" : "META",
    "title" : "Multiscale Semi-Markov Dynamics for Intracortical Brain-Computer Interfaces",
    "authors" : [ "Daniel J. Milstein", "Jason L. Pacheco", "Leigh R. Hochberg", "John D. Simeral", "Beata Jarosiewicz", "Erik B. Sudderth" ],
    "emails" : [ "daniel_milstein@alumni.brown.edu", "pachecoj@mit.edu", "leigh_hochberg@brown.edu", "john_simeral@brown.edu", "beataj@stanford.edu", "sudderth@uci.edu" ],
    "sections" : [ {
      "heading" : "1 Introduction",
      "text" : "Paralysis of all four limbs from injury or disease, or tetraplegia, can severely limit function, independence, and even sometimes communication. Despite its inability to effect movement in muscles, neural activity in motor cortex still modulates according to people’s intentions to move their paralyzed arm or hand, even years after injury [Hochberg et al., 2006, Simeral et al., 2011, Hochberg et al., ∗Department of Computer Science, Brown University, Providence, RI, USA. †Computer Science and Artificial Intelligence Laboratory, MIT, Cambridge, MA, USA. ‡School of Engineering, Brown University, Providence, RI, USA; and Department of Neurology, Massachusetts General Hospital, Boston, MA, USA. §Rehabilitation R&D Service, Department of Veterans Affairs Medical Center, Providence, RI, USA; and Brown Institute for Brain Science, Brown University, Providence, RI, USA. ¶Department of Neurology, Harvard Medical School, Boston, MA, USA. ‖Department of Neuroscience, Brown University, Providence, RI, USA. ∗∗Present affiliation: Dept. of Neurosurgery, Stanford University, Stanford, CA, USA. ††Department of Computer Science, University of California, Irvine, CA, USA.\n31st Conference on Neural Information Processing Systems (NIPS 2017), Long Beach, CA, USA.\n2012, Collinger et al., 2013]. Intracortical brain-computer interfaces (iBCIs) utilize neural signals recorded from implanted electrode arrays to extract information about movement intentions. They have enabled individuals with tetraplegia to control a computer cursor to engage in tasks such as on-screen typing [Bacher et al., 2015, Jarosiewicz et al., 2015, Pandarinath et al., 2017], and to regain volitional control of their own limbs [Ajiboye et al., 2017].\nCurrent iBCIs are based on a Kalman filter that assumes the vector of desired cursor movement evolves according to Gaussian random walk dynamics, and that neural activity is a Gaussian-corrupted linear function of this state [Kim et al., 2008]. In Sec. 2, we review how the Kalman filter is applied to neural decoding, and studies of the motor cortex by Georgopoulos et al. [1982] that justify its use. In Sec. 3, we improve upon the Kalman filter’s linear observation model by introducing a flexible, multimodal likelihood inspired by more recent research [Amirikian and Georgopulos, 2000]. Sec. 4 then proposes a graphical model (a dynamic Bayesian network [Murphy, 2002]) for the relationship between the angle of intended movement and the intended on-screen goal position. We derive an efficient inference algorithm via an online variant of the junction tree algorithm [Boyen and Koller, 1998]. In Sec. 5, we use recorded neural data to validate the components of our multiscale semiMarkov (MSSM) model, and demonstrate significantly improved prediction of motion directions in offline analysis. Via a real time implementation of the inference algorithm on a constrained embedded system, we then evaluate online decoding performance as a participant in the BrainGate21 iBCI pilot clinical trial uses the MSSM model to control a computer cursor with his neural activity."
    }, {
      "heading" : "2 Neural decoding via a Kalman filter",
      "text" : "The Kalman filter is the current state-of-the-art for iBCI decoding. There are several configurations of the Kalman filter used to enable cursor control in contemporary iBCI systems [Pandarinath et al., 2017, Jarosiewicz et al., 2015, Gilja et al., 2015] and there is no broad consensus in the iBCI field on which is most suited for clinical use. In this paper, we focus on the variant described by Jarosiewicz et al. [2015].\nParticipants in the BrainGate2 clinical trial receive one or two microelectrode array implants in the motor cortex (see Fig. 1). The electrical signals recorded by this electrode array are then transformed (via signal processing methods designed to reduce noise) into a D-dimensional neural activity vector zt ∈ RD, sampled at 50 Hz. From the sequence of neural activity, the Kalman filter estimates the latent state xt ∈ R2, a vector pointing in the intended direction of cursor motion. The Kalman filter assumes a jointly Gaussian model for cursor dynamics and neural activity,\nxt | xt−1 ∼ N (Axt−1,W ), zt | xt ∼ N (b+Hxt, Q), (1) with cursor dynamics A ∈ R2×2, process noise covariance W ∈ R2×2, and (typically non-diagonal) observation covariance Q ∈ RD×D. At each time step, the on-screen cursor’s position is moved by the estimated latent state vector (decoder output) scaled by a constant, the speed gain.\nThe function relating neural activity to some measurable quantity of interest is called a tuning curve. A common model of neural activity in the motor cortex assumes that each neuron’s activity is highest\n1Caution: Investigational Device. Limited by Federal Law to Investigational Use.\nfor some preferred direction of motion, and lowest in the opposite direction, with intermediate activity often resembling a cosine function. This cosine tuning model is based on pioneering studies of the motor cortex of non-human primates [Georgopoulos et al., 1982], and is commonly used (or implicitly assumed) in iBCI systems because of its mathematical simplicity and tractability.\nExpressing the inner product between vectors via the cosine of the angle between them, the expected neural activity of the jth component of Eq. (1) can be written as\nE[ztj | xt] = bj + hTj xt = bj + ||xt|| · ||hj || · cos ( θt − atan ( hj2 hj1 )) , (2)\nwhere θt is the intended angle of movement at timestep t, bj is the baseline activity rate for channel j, and hj is the jth row of the observation matrix H = (hT1 , . . . , h T D)\nT . If xt is further assumed to be a unit vector (a constraint not enforced by the Kalman filter), Eq. (2) simplifies to hTj xt = mj cos(θt−pj), where mj is the modulation of the tuning curve and pj specifies the angular location of the peak of the cosine tuning curve (the preferred direction). Thus, cosine tuning models are linear.\nTo collect labeled training data for decoder calibration, the participant is asked to attempt to move a cursor to prompted target locations. We emphasize that although the clinical random target task displays only one target at a time, this target position is unknown to the decoder. Labels are constructed for the neural activity patterns by assuming that at each 20ms time step, the participant intends to move the cursor straight to the target [Jarosiewicz et al., 2015, Gilja et al., 2015]. These labeled data are used to fit the observation matrix H and neuron baseline rates (biases) b via ridge regression. The observation noise covariance Q is estimated as the empirical covariance of the residuals. The state dynamics matrix A and process covariance matrix W may be tuned to adjust the responsiveness of the iBCI system."
    }, {
      "heading" : "3 Flexible tuning likelihoods",
      "text" : "The cosine tuning model reviewed in the previous section has several shortcomings. First, motor cortical neurons that have unimodal tuning curves often have narrower peaks that are better described by von Mises distributions [Amirikian and Georgopulos, 2000]. Second, tuning can be multimodal. Third, neural features used for iBCI decoding may capture the pooled activity of several neurons, not just one [Fraser et al., 2009]. While bimodal von Mises models were introduced by Amirikian and Georgopulos [2000], up to now iBCI decoders based on von Mises tuning curves have only employed unimodal mean functions proportional to a single von Mises density [Koyama et al., 2010]. In contrast, we introduce a multimodal likelihood proportional to an arbitrary number of regularly spaced von Mises densities and incorporate this likelihood into an iBCI decoder. Moreover, we can efficiently fit parameters of this new likelihood via ridge regression. Computational efficiency is crucial to allow rapid calibration in clinical applications.\nLet θt ∈ [0, 2π) denote the intended angle of cursor movement at time t. The flexible tuning likelihood captures more complex neural activity distributions via a regression model with nonlinear features:\nzt | θt ∼ N ( b+ wTφ(θt), Q ) , φk(θt) = exp [ cos (θt − ϕk)] . (3)\nThe features are a set of K von Mises basis functions φ(θ) = (φ1(θ), . . . , φK(θ))T . Basis functions φk(x) are centered on a regular grid of angles ϕk, and have tunable concentration .\nUsing human neural data recorded during cued target tasks, we compare regression fits for the flexible tuning model to the standard cosine tuning model (Fig. 2). In addition to providing better fits for channels with complex or multimodal activity, the flexible tuning model also provides good fits to apparently cosine-tuned signals. This leads to higher predictive likelihoods for held-out data, and as we demonstrate in Sec. 5, more accurate neural decoding algorithms."
    }, {
      "heading" : "4 Multiscale Semi-Markov Dynamical Models",
      "text" : "The key observation underlying our multiscale dynamical model is that the sampling rate used for neural decoding (typically around 50 Hz) is much faster than the rate that the goal position changes (under normal conditions, every few seconds). In addition, frequent but small adjustments of cursor aim angle are required to maintain a steady heading. State-of-the-art Kalman filter approaches to iBCIs\nare incapable of capturing these multiscale dynamics since they assume first-order Markov dependence across time and do not explicitly represent goal position. To cope with this, hyperparameters of the linear Gaussian dynamics must be tuned to simultaneously remain sensitive to frequent directional adjustments, but not so sensitive that cursor dynamics are dominated by transient neural activity.\nOur proposed MSSM decoder, by contrast, explicitly represents goal position in addition to cursor aim angle. Through the use of semi-Markov dynamics, the MSSM enables goal position to evolve at a different rate than cursor angle while allowing for a high rate of neural data acquisition. In this way, the MSSM can integrate across different timescales to more robustly infer the (unknown) goal position and the (also unknown) cursor aim. We introduce the model in Sec. 4.1 and 4.2. We derive an efficient decoding algorithm, based on an online variant of the junction tree algorithm, in Sec. 4.3."
    }, {
      "heading" : "4.1 Modeling Goals and Motion via a Dynamic Bayesian Network",
      "text" : "The MSSM directed graphical model (Fig. 3) uses a structured latent state representation, sometimes referred to as a dynamic Bayesian network [Murphy, 2002]. This factorization allows us to discretize latent state variables, and thereby support non-Gaussian dynamics and data likelihoods. At each time t we represent discrete cursor aim θt as 72 values in [0, 2π) and goal position gt as a regular grid of 40× 40 = 1600 locations (see Fig. 4). Each cell of the grid is small compared to elements of a graphical interface. Cursor aim dynamics are conditioned on goal position and evolve according to a smoothed von Mises distribution:\nvMS(θt | gt, pt) , α/2π + (1− α)vonMises(θt | a(gt, pt), κ̄). (4) Here, a(g, p) = tan−1((gy − py)/(gx − px)) is the angle from the cursor p = (px, py) to the goal g = (gx, gy), and the concentration parameter κ̄ encodes the expected accuracy of user aim. Neural activity from some participants has short bursts of noise during which the learned angle likelihood is inaccurate; the outlier weight 0 < α < 1 adds robustness to these noise bursts."
    }, {
      "heading" : "4.2 Multiscale Semi-Markov Dynamics",
      "text" : "The first-order Markov assumption made by existing iBCI decoders (see Eq. (1)) imposes a geometric decay in state correlation over time. For example, consider a scalar Gaussian state-space model: xt = βxt−1 +v, v ∼ N (0, σ2). For time lag k > 0, the covariance between two states cov(xt, xt+k) decays as β−k. This weak temporal dependence is highly problematic in the iBCI setting due to the mismatch between downsampled sensor acquisition rates used for decoding (typically around 50Hz, or 20ms per timestep) and the time scale at which the desired goal position changes (seconds).\nWe relax the first-order Markov assumption via a semi-Markov model of state dynamics [Yu, 2010]. Semi-Markov models, introduced by Levy [1954] and Smith [1955], divide the state evolution into contiguous segments. A segment is a contiguous series of timesteps during which a latent variable is unchanged. The conditional distribution over the state at time xt depends not only on the previous state xt−1, but also on a duration dt which encodes how long the state is to remain unchanged:\np(xt | xt−1, dt). Duration is modeled via a latent counter variable, which is drawn at the start of each segment and decremented deterministically until it reaches zero, at which point it is resampled. In this way the semi-Markov model is capable of integrating information over longer time horizons, and thus less susceptible to intermittent bursts of sensor noise.\nWe define separate semi-Markov dynamical models for the goal position and the angle of intended movement. As detailed in the supplement, in experiments our duration distributions were uniform, with parameters informed by knowledge about typical trajectory durations and reaction times.\nGoal Dynamics A counter ct encodes the temporal evolution of the semi-Markov dynamics on goal positions: ct is drawn from a discrete distribution p(c) at the start of each trajectory, and then decremented deterministically until it reaches zero. (During decoding we do not know the value of the counter, and maintain a posterior probability distribution over its value.) The goal position gt remains unchanged until the goal counter reaches zero, at which point with probability η we resample a new goal, and we keep the same goal with the remaining probability 1− η:\np(ct | ct−1) = { 1, ct = ct−1 − 1, ct−1 > 0, Decrement p(ct), ct−1 = 0, Sample new counter 0, Otherwise\n(5)\np(gt | ct−1, gt−1) =  1, ct−1 > 0, gt = gt−1, Goal position unchanged η 1G + (1− η), ct−1 = 0, gt = gt−1, Sample same goal position η 1G , ct−1 = 0, gt 6= gt−1, Sample new goal position 0, Otherwise (6)\nCursor Angle Dynamics We define similar semi-Markov dynamics for the cursor angle via an aim counter bt. Once the counter reaches zero, we sample a new aim counter value from the discrete distribution p(b), and a new cursor aim angle from the smoothed von Mises distribution of Eq. (4):\np(bt | bt−1) = { 1, bt = bt−1 − 1, bt−1 > 0, Decrement p(bt), bt−1 = 0, Sample new counter 0, Otherwise\n(7)\np(θt | bt−1, θt−1, pt, gt) = { θt−1 bt−1 > 0, Keep cursor aim vMS(θt | gt, pt) bt−1 = 0, Sample new cursor aim (8)"
    }, {
      "heading" : "4.3 Decoding via Approximate Online Inference",
      "text" : "Efficient decoding is possible via an approximate variant of the junction tree algorithm [Boyen and Koller, 1998]. We approximate the full posterior at time t via a partially factorized posterior:\np(gt, ct, θt, bt | z1...t) ≈ p(gt, ct | z1...t)p(θt, bt | z1...t). (9)\nHere p(gt, ct | z1...t) is the marginal on the goal position and goal counter, and p(θt, bt | z1...t) is the marginal on the angle of aim and the aim counter. Note that in this setting goal position gt and cursor aim θt, as well as their respective counters ct and bt, are unknown and must be inferred from neural data. At each inference step we use the junction tree algorithm to compute state marginals at time t, conditioned on the factorized posterior approximation from time step t− 1 (see Fig. 3). Boyen and Koller [1998] show that this technique has bounded approximation error over time, and Murphy and Weiss [2001] show this as a special case of loopy belief propagation.\nDetailed inference equations are derived in the supplemental material. Given G goal positions and A discrete angle states, each temporal update for our online decoder requires O(GA + A2) operations. In contrast, the exact junction tree algorithm would require O(G2A2) operations; for practical numbers of goals G, realtime implementation of this exact decoder is infeasible.\nFigure 4 shows several snapshots of the marginal posterior over goal position. At each time the MSSM decoder moves the cursor along the vector E [ gt−pt ‖gt−pt‖ ] , computed by taking an average of the directions needed to get to each possible goal, weighted by the inferred probability that each goal is the participant’s true target. This vector is smaller in magnitude when the decoder is less certain about the direction in which the intended goal lies, which has the practical benefit of allowing the participant to slow down near the goal."
    }, {
      "heading" : "5 Experiments",
      "text" : "We evaluate all decoders under a variety of conditions and a range of configurations for each decoder. Controlled offline evaluations allow us to assess the impact of each proposed innovation. To analyze the effects of our proposed likelihood and multiscale dynamics in isolation, we construct a baseline hidden Markov model (HMM) decoder using the same discrete representation of angles as the MSSM, and either cosine-tuned or flexible likelihoods. Our findings show that the offline decoding performance of the MSSM is superior in all respects to baseline models.\nWe also evaluate the MSSM decoder in two online clinical research sessions, and compare headto-head performance with the Kalman filter. Previous studies have tested the Kalman filter under a variety of responsive parameter configurations and found a tradeoff between slow, smooth control versus fast, meandering control [Willett et al., 2016, 2017]. Through comparisons to the Kalman, we demonstrate that the MSSM decoder maintains smoother and more accurate control at comparable speeds. These realtime results are preliminary since we have yet to evaluate the MSSM decoder on other clinical metrics such as communication rate."
    }, {
      "heading" : "5.1 Offline evaluation",
      "text" : "We perform offline analysis using previously recorded data from two historical sessions of iBCI use with a single participant (T9). During each session the participant is asked to perform a cued target task in which a target appears at a random location on the screen and the participant attempts to move the cursor to the target. Once the target is acquired or after a timeout (10 seconds), a new target is presented at a different location. Each session is composed of several 3 minute segments or blocks.\nTo evaluate the effect of each innovation we compare to an HMM decoder. This HMM baseline isolates the effect of our flexible likelihood since, like the Kalman filter, it does not model goal positions and assumes first-order Markov dynamics. Let θt be the latent angle state at time t and x(θ) = (cos(θ), sin(θ))\nT the corresponding unit vector. We implement a pair of HMM decoders for cosine tuning and our proposed flexible tuning curves,\nzt | θt ∼ N (b+Hx(θt), Q)︸ ︷︷ ︸ Cosine HMM\n, zt | θt ∼ N ( b+ wTφ(θt), Q )︸ ︷︷ ︸ Flexible HMM\nHere, φ(·) are the basis vectors defined in Eq. (3). The state θt is discrete, taking one of 72 angular values equally spaced in [0, 2π), the same discretization used by the MSSM. Continuous densities are appropriately normalized. Unlike the linear Gaussian state-space model, the HMMs constrain latent states to be valid angles (equivalently, unit vectors) rather than arbitrary vectors in R2. We analyze decoder accuracy within each session using a leave-one-out approach. Specifically, we test the decoder on each held-out block using the remaining blocks in the same session for training. We report MSE of the predicted cursor direction, using the unit vector from the cursor to the target as ground truth, and normalizing decoder output vectors. We used the same recorded data for each decoder. See the supplement for further details.\nFigure 5 summarizes the findings of the offline comparisons for a variety of decoder configurations. First, we evaluate the effect of preprocessing the data by taking the square root, applying a low-pass IIR filter, and clipping the data outside a 5σ threshold, where σ is the empirical standard deviation of training data. This preprocessing significantly improves accuracy for all decoders. The MSSM model compares favorably to all configurations of the Kalman decoders. The majority of benefit comes from the semi-Markov dynamical model, but additional gains are observed when including the flexible tuning likelihood. Finally, it has been observed that the Kalman decoder is sensitive to outliers for which Jarosiewicz et al. [2015] propose a correction to avoid biased estimates. We test the Kalman filter with and without this correction."
    }, {
      "heading" : "5.2 Realtime evaluation",
      "text" : "Next, we examined whether the MSSM method was effective for realtime iBCI control by a clinical trial participant. On two different days, a clinical trial participant (T10) completed six four-minute comparison blocks. In these blocks, we alternated using an MSSM decoder with flexible likelihoods and novel preprocessing, or a standard Kalman decoder. As with the Kalman decoding described in Jarosiewicz et al. [2015], we used the Kalman filter in conjunction with a bias correcting postprocessing heuristic. We used the feature selection method proposed by Malik et al. [2015] to select D = 60 channels of neural data, and used these same 60 channels for both decoders.\nJarosiewicz et al. [2015] selected the timesteps of data to use for parameter learning by taking the first two seconds of each trajectory after a 0.3s reaction time. For both decoders, we instead selected all timesteps in which the cursor was a fixed distance from the cued goal because we found this alternative method lead to improvements in offline decoding. Both methods for selecting subsets of the calibration data are designed to compensate for the fact that vectors from cursor to target are not a reliable estimator for participants’ intended aim when the cursor is near the target.\nDecoding accuracy. Figure 6 shows that our MSSM decoder had less directional error than the configuration of the Kalman filter that we compared to. We confirmed the statistical significance of this result using a Wilcoxon rank sum test. To accommodate the Wilcoxon rank sum test’s independence assumption, we divided the data into individual trajectories from a starting point towards a goal, that ended either when the cursor reached the goal or at a timeout (10 seconds). We then computed the mean squared error of each trajectory, where the squared error is the squared Euclidean distance between the normalized (unit vector) decoded vectors and the unit vectors from cursor to target. Within each session, we compared the distributions of these mean squared errors for trajectories between decoders (p < 10−6 for each session). MSSM also performed better than the Kalman on metrics from MacKenzie et al. [2001] that measure the smoothness of cursor trajectories (see Fig. 6).\nFigure 7 shows example trajectories as the cursor moves toward its target via the MSSM decoder or the (bias-corrected) Kalman decoder. Consistent with the quantitative error metrics, the trajectories produced by the MSSM model were smoother and more direct than those of the Kalman filter, especially as the cursor approached the goal. The distance ratio (the ratio of the length of the trajectory to the line from the starting position to the goal) averaged 1.17 for the MSSM decoder and 1.28 for the Kalman decoder, a significant difference (Wilcoxon rank sum test, p < 10−6). Some trajectories for both decoders are shown in Figure 7. Videos of cursor movement under both decoding algorithms, and additional experimental details, are included in the supplemental material.\nDecoding speed. We controlled for speed by configuring both decoders to average the same fast speed determined in collaboration with clinical research engineers familiar with the participant’s preferred cursor speed. For each decoder, we collected a block of data in which the participant used\nthat decoder to control the cursor. For each of these blocks, we computed the trimmed mean of the speed, and then linearly extrapolated the speed gain needed for the desired speed. Although such an extrapolation is approximate, the average times to acquire a target with each decoder at the extrapolated speed gains were within 6% of each other: 2.6s for the Kalman decoder versus 2.7s for the MSSM decoder. This speed discrepancy is dominated by the relative performance improvement of MSSM over Kalman: the Kalman had a 30.7% greater trajectory mean squared error, 249% more orthogonal direction changes, and 224% more movement direction changes.\nThis approach to evaluating decoder performance differs from that suggested by Willett et al. [2016], which discusses the possibility of optimizing the speed gain and other decoder parameters to minimize target acquisition time. In contrast, we matched the speed of both decoders and evaluated decoding error and smoothness. We did not extensively tune the dynamics parameters for either decoder, instead relying on the Kalman parameters in everyday use by T10. For MSSM we tried two values of η, which controls the sampling of goal states (6), and chose the remaining parameters offline."
    }, {
      "heading" : "6 Conclusion",
      "text" : "We introduce a flexible likelihood model and multiscale semi-Markov (MSSM) dynamics for cursor control in intracortical brain-computer interfaces. The flexible tuning likelihood model extends the cosine tuning model to allow for multimodal tuning curves and narrower peaks. The MSSM dynamic Bayesian network explicitly models the relationship between the goal position, the cursor position, and the angle of intended movement. Because the goal position changes much less frequently than the angle of intended movement, a decoder’s past knowledge of the goal position stays relevant for longer, and the MSSM model can use longer histories of neural activity to infer the direction of desired movement.\nTo create a realtime decoder, we derive an online variant of the junction tree algorithm with provable accuracy guarantees. We demonstrate a significant improvement over the Kalman filter in offline experiments with neural recordings, and demonstrate promising preliminary results in clinical trial tests. As seen in the videos, the MSSM decoder yields an appreciably straighter and smoother trajectory than the Kalman decoder. Future work will further evaluate the suitability of this method for clinical use. We hope that the MSSM graphical model will also enable further advances in iBCI decoding, for example by encoding the structure of a known user interface in the set of latent goals.\nAuthor contributions DJM, JLP, and EBS created the flexible tuning likelihood and the multiscale semi-Markov dynamics. DJM derived the inference (decoder), wrote software implementations of these methods, and performed data analyses. DJM, JLP, and EBS designed offline experiments. DJM, BJ, and JDS designed clinical research sessions. LRH is the sponsor-investigator of the BrainGate2 pilot clinical trial. DJM, JLP, and EBS wrote the manuscript with input from all authors."
    }, {
      "heading" : "Acknowledgments",
      "text" : "The authors thank Participants T9 and T10 and their families, Brian Franco, Tommy Hosman, Jessica Kelemen, Dave Rosler, Jad Saab, and Beth Travers for their contributions to this research. Support for this study was provided by the Office of Research and Development, Rehabilitation R&D Service, Department of Veterans Affairs (B4853C, B6453R, and N9228C), the National Institute on Deafness and Other Communication Disorders of National Institutes of Health (NIDCD-NIH: R01DC009899), MGH-Deane Institute, and The Executive Committee on Research (ECOR) of Massachusetts General Hospital. The content is solely the responsibility of the authors and does not necessarily represent the official views of the National Institutes of Health, or the Department of Veterans Affairs or the United States Government. CAUTION: Investigational Device. Limited by Federal Law to Investigational Use.\nDisclosure: Dr. Hochberg has a financial interest in Synchron Med, Inc., a company developing a minimally invasive implantable brain device that could help paralyzed patients achieve direct brain control of assistive technologies. Dr. Hochberg’s interests were reviewed and are managed by Massachusetts General Hospital, Partners HealthCare, and Brown University in accordance with their conflict of interest policies."
    } ],
    "references" : [ {
      "title" : "Restoration of reaching and grasping movements through brain-controlled muscle stimulation in a person with tetraplegia",
      "author" : [ "A.B. Ajiboye", "F.R. Willett", "D.R. Young", "W.D. Memberg", "B.A. Murphy", "J.P. Miller", "B.L. Walter", "J.A. Sweet", "H.A. Hoyen", "M.W. Keith" ],
      "venue" : null,
      "citeRegEx" : "Ajiboye et al\\.,? \\Q2017\\E",
      "shortCiteRegEx" : "Ajiboye et al\\.",
      "year" : 2017
    }, {
      "title" : "Directional tuning profiles of motor cortical cells",
      "author" : [ "B. Amirikian", "A.P. Georgopulos" ],
      "venue" : "J. Neurosci. Res.,",
      "citeRegEx" : "Amirikian and Georgopulos.,? \\Q2000\\E",
      "shortCiteRegEx" : "Amirikian and Georgopulos.",
      "year" : 2000
    }, {
      "title" : "Neural point-and-click communication by a person with incomplete locked-in syndrome",
      "author" : [ "D. Bacher", "B. Jarosiewicz", "N.Y. Masse", "S.D. Stavisky", "J.D. Simeral", "K. Newell", "E.M. Oakley", "S.S. Cash", "G. Friehs", "L.R. Hochberg" ],
      "venue" : "Neurorehabil Neural Repair,",
      "citeRegEx" : "Bacher et al\\.,? \\Q2015\\E",
      "shortCiteRegEx" : "Bacher et al\\.",
      "year" : 2015
    }, {
      "title" : "Tractable inference for complex stochastic processes",
      "author" : [ "X. Boyen", "D. Koller" ],
      "venue" : "In Proceedings of UAI,",
      "citeRegEx" : "Boyen and Koller.,? \\Q1998\\E",
      "shortCiteRegEx" : "Boyen and Koller.",
      "year" : 1998
    }, {
      "title" : "High-performance neuroprosthetic control by an individual with tetraplegia",
      "author" : [ "J.L. Collinger", "B. Wodlinger", "J.E. Downey", "W. Wang", "E.C. Tyler-Kabara", "D.J. Weber", "A.J. McMorland", "M. Velliste", "M.L. Boninger", "A.B. Schwartz" ],
      "venue" : null,
      "citeRegEx" : "Collinger et al\\.,? \\Q2013\\E",
      "shortCiteRegEx" : "Collinger et al\\.",
      "year" : 2013
    }, {
      "title" : "Control of a brain–computer interface without spike sorting",
      "author" : [ "G.W. Fraser", "S.M. Chase", "A. Whitford", "A.B. Schwartz" ],
      "venue" : "J. Neuroeng,",
      "citeRegEx" : "Fraser et al\\.,? \\Q2009\\E",
      "shortCiteRegEx" : "Fraser et al\\.",
      "year" : 2009
    }, {
      "title" : "On the relations between the direction of two-dimensional arm movements and cell discharge in primate motor cortex",
      "author" : [ "A.P. Georgopoulos", "J.F. Kalaska", "R. Caminiti", "J.T. Massey" ],
      "venue" : "J. Neurosci.,",
      "citeRegEx" : "Georgopoulos et al\\.,? \\Q1982\\E",
      "shortCiteRegEx" : "Georgopoulos et al\\.",
      "year" : 1982
    }, {
      "title" : "Clinical translation of a high performance neural prosthesis",
      "author" : [ "V. Gilja", "C. Pandarinath", "C.H. Blabe", "P. Nuyujukian", "J.D. Simeral", "A.A. Sarma", "B.L. Sorice", "J.A. Perge", "B. Jarosiewicz", "L.R. Hochberg" ],
      "venue" : "Nature Medicine,",
      "citeRegEx" : "Gilja et al\\.,? \\Q2015\\E",
      "shortCiteRegEx" : "Gilja et al\\.",
      "year" : 2015
    }, {
      "title" : "Neuronal ensemble control of prosthetic devices by a human with tetraplegia",
      "author" : [ "L.R. Hochberg", "M.D. Serruya", "G.M. Friehs", "J.A. Mukand", "M. Saleh", "A.H. Caplan", "A. Branner", "D. Chen", "R.D. Penn", "J.P. Donoghue" ],
      "venue" : "Nature, 442(7099):164–171,",
      "citeRegEx" : "Hochberg et al\\.,? \\Q2006\\E",
      "shortCiteRegEx" : "Hochberg et al\\.",
      "year" : 2006
    }, {
      "title" : "Reach and grasp by people with tetraplegia using a neurally controlled robotic arm",
      "author" : [ "L.R. Hochberg", "D. Bacher", "B. Jarosiewicz", "N.Y. Masse", "J.D. Simeral", "J. Vogel", "S. Haddadin", "J. Liu", "S.S. Cash", "P. van der Smagt" ],
      "venue" : null,
      "citeRegEx" : "Hochberg et al\\.,? \\Q2012\\E",
      "shortCiteRegEx" : "Hochberg et al\\.",
      "year" : 2012
    }, {
      "title" : "Virtual typing by people with tetraplegia using a self-calibrating intracortical brain-computer interface",
      "author" : [ "B. Jarosiewicz", "A.A. Sarma", "D. Bacher", "N.Y. Masse", "J.D. Simeral", "B. Sorice", "E.M. Oakley", "C. Blabe", "C. Pandarinath", "V. Gilja" ],
      "venue" : "Sci. Transl. Med.,",
      "citeRegEx" : "Jarosiewicz et al\\.,? \\Q2015\\E",
      "shortCiteRegEx" : "Jarosiewicz et al\\.",
      "year" : 2015
    }, {
      "title" : "Neural control of computer cursor velocity by decoding motor cortical spiking activity in humans with tetraplegia",
      "author" : [ "S.P. Kim", "J.D. Simeral", "L.R. Hochberg", "J.P. Donoghue", "M.J. Black" ],
      "venue" : "J. Neuroeng,",
      "citeRegEx" : "Kim et al\\.,? \\Q2008\\E",
      "shortCiteRegEx" : "Kim et al\\.",
      "year" : 2008
    }, {
      "title" : "Comparison of brain–computer interface decoding algorithms in open-loop and closed-loop control",
      "author" : [ "S. Koyama", "S.M. Chase", "A.S. Whitford", "M. Velliste", "A.B. Schwartz", "R.E. Kass" ],
      "venue" : "J Comput Neurosci,",
      "citeRegEx" : "Koyama et al\\.,? \\Q2010\\E",
      "shortCiteRegEx" : "Koyama et al\\.",
      "year" : 2010
    }, {
      "title" : "Semi-Markovian processes",
      "author" : [ "P. Levy" ],
      "venue" : "Proc: III ICM (Amsterdam),",
      "citeRegEx" : "Levy.,? \\Q1954\\E",
      "shortCiteRegEx" : "Levy.",
      "year" : 1954
    }, {
      "title" : "Accuracy measures for evaluating computer pointing devices",
      "author" : [ "I.S. MacKenzie", "T. Kauppinen", "M. Silfverberg" ],
      "venue" : "In Proceedings of CHI,",
      "citeRegEx" : "MacKenzie et al\\.,? \\Q2001\\E",
      "shortCiteRegEx" : "MacKenzie et al\\.",
      "year" : 2001
    }, {
      "title" : "Modulation depth estimation and variable selection in state-space models for neural interfaces",
      "author" : [ "W.Q. Malik", "L.R. Hochberg", "J.P. Donoghue", "E.N. Brown" ],
      "venue" : "IEEE Trans Biomed Eng,",
      "citeRegEx" : "Malik et al\\.,? \\Q2015\\E",
      "shortCiteRegEx" : "Malik et al\\.",
      "year" : 2015
    }, {
      "title" : "The factored frontier algorithm for approximate inference in DBNs",
      "author" : [ "K. Murphy", "Y. Weiss" ],
      "venue" : "In Proceedings of UAI,",
      "citeRegEx" : "Murphy and Weiss.,? \\Q2001\\E",
      "shortCiteRegEx" : "Murphy and Weiss.",
      "year" : 2001
    }, {
      "title" : "Dynamic Bayesian networks: Representation, inference and learning",
      "author" : [ "K.P. Murphy" ],
      "venue" : "PhD thesis,",
      "citeRegEx" : "Murphy.,? \\Q2002\\E",
      "shortCiteRegEx" : "Murphy.",
      "year" : 2002
    }, {
      "title" : "High performance communication by people with paralysis using an intracortical brain-computer",
      "author" : [ "C. Pandarinath", "P. Nuyujukian", "C.H. Blabe", "B.L. Sorice", "J. Saab", "F.R. Willett", "L.R. Hochberg", "K.V. Shenoy", "J.M. Henderson" ],
      "venue" : "interface. eLife,",
      "citeRegEx" : "Pandarinath et al\\.,? \\Q2017\\E",
      "shortCiteRegEx" : "Pandarinath et al\\.",
      "year" : 2017
    }, {
      "title" : "Neural control of cursor trajectory and click by a human with tetraplegia 1000 days after implant of an intracortical microelectrode array",
      "author" : [ "J.D. Simeral", "S.P. Kim", "M. Black", "J. Donoghue", "L. Hochberg" ],
      "venue" : "J. Neuroeng,",
      "citeRegEx" : "Simeral et al\\.,? \\Q2011\\E",
      "shortCiteRegEx" : "Simeral et al\\.",
      "year" : 2011
    }, {
      "title" : "Regenerative stochastic processes",
      "author" : [ "W.L. Smith" ],
      "venue" : "Proceedings of the Royal Society of London A: Mathematical, Physical and Engineering Sciences,",
      "citeRegEx" : "Smith.,? \\Q1955\\E",
      "shortCiteRegEx" : "Smith.",
      "year" : 1955
    }, {
      "title" : "Feedback control policies employed by people using intracortical brain–computer interfaces",
      "author" : [ "F.R. Willett", "C. Pandarinath", "B. Jarosiewicz", "B.A. Murphy", "W.D. Memberg", "C.H. Blabe", "J. Saab", "B.L. Walter", "J.A. Sweet", "J.P. Miller" ],
      "venue" : "J. Neuroeng,",
      "citeRegEx" : "Willett et al\\.,? \\Q2016\\E",
      "shortCiteRegEx" : "Willett et al\\.",
      "year" : 2016
    }, {
      "title" : "Signal-independent noise in intracortical brain– computer interfaces causes movement time properties inconsistent with Fitts",
      "author" : [ "F.R. Willett", "B.A. Murphy", "W.D. Memberg", "C.H. Blabe", "C. Pandarinath", "B.L. Walter", "J.A. Sweet", "J.P. Miller", "J.M. Henderson", "K.V. Shenoy" ],
      "venue" : "law. J. Neuroeng,",
      "citeRegEx" : "Willett et al\\.,? \\Q2017\\E",
      "shortCiteRegEx" : "Willett et al\\.",
      "year" : 2017
    }, {
      "title" : "Hidden semi-Markov models",
      "author" : [ "S.Z. Yu" ],
      "venue" : "Artificial intelligence,",
      "citeRegEx" : "Yu.,? \\Q2010\\E",
      "shortCiteRegEx" : "Yu.",
      "year" : 2010
    } ],
    "referenceMentions" : [ {
      "referenceID" : 0,
      "context" : ", 2017], and to regain volitional control of their own limbs [Ajiboye et al., 2017].",
      "startOffset" : 61,
      "endOffset" : 83
    }, {
      "referenceID" : 11,
      "context" : "Current iBCIs are based on a Kalman filter that assumes the vector of desired cursor movement evolves according to Gaussian random walk dynamics, and that neural activity is a Gaussian-corrupted linear function of this state [Kim et al., 2008].",
      "startOffset" : 225,
      "endOffset" : 243
    }, {
      "referenceID" : 1,
      "context" : "3, we improve upon the Kalman filter’s linear observation model by introducing a flexible, multimodal likelihood inspired by more recent research [Amirikian and Georgopulos, 2000].",
      "startOffset" : 146,
      "endOffset" : 179
    }, {
      "referenceID" : 17,
      "context" : "4 then proposes a graphical model (a dynamic Bayesian network [Murphy, 2002]) for the relationship between the angle of intended movement and the intended on-screen goal position.",
      "startOffset" : 62,
      "endOffset" : 76
    }, {
      "referenceID" : 3,
      "context" : "We derive an efficient inference algorithm via an online variant of the junction tree algorithm [Boyen and Koller, 1998].",
      "startOffset" : 96,
      "endOffset" : 120
    }, {
      "referenceID" : 0,
      "context" : ", 2017], and to regain volitional control of their own limbs [Ajiboye et al., 2017]. Current iBCIs are based on a Kalman filter that assumes the vector of desired cursor movement evolves according to Gaussian random walk dynamics, and that neural activity is a Gaussian-corrupted linear function of this state [Kim et al., 2008]. In Sec. 2, we review how the Kalman filter is applied to neural decoding, and studies of the motor cortex by Georgopoulos et al. [1982] that justify its use.",
      "startOffset" : 62,
      "endOffset" : 466
    }, {
      "referenceID" : 7,
      "context" : ", 2015, Gilja et al., 2015] and there is no broad consensus in the iBCI field on which is most suited for clinical use. In this paper, we focus on the variant described by Jarosiewicz et al. [2015]. Participants in the BrainGate2 clinical trial receive one or two microelectrode array implants in the motor cortex (see Fig.",
      "startOffset" : 8,
      "endOffset" : 198
    }, {
      "referenceID" : 6,
      "context" : "This cosine tuning model is based on pioneering studies of the motor cortex of non-human primates [Georgopoulos et al., 1982], and is commonly used (or implicitly assumed) in iBCI systems because of its mathematical simplicity and tractability.",
      "startOffset" : 98,
      "endOffset" : 125
    }, {
      "referenceID" : 1,
      "context" : "First, motor cortical neurons that have unimodal tuning curves often have narrower peaks that are better described by von Mises distributions [Amirikian and Georgopulos, 2000].",
      "startOffset" : 142,
      "endOffset" : 175
    }, {
      "referenceID" : 5,
      "context" : "Third, neural features used for iBCI decoding may capture the pooled activity of several neurons, not just one [Fraser et al., 2009].",
      "startOffset" : 111,
      "endOffset" : 132
    }, {
      "referenceID" : 12,
      "context" : "While bimodal von Mises models were introduced by Amirikian and Georgopulos [2000], up to now iBCI decoders based on von Mises tuning curves have only employed unimodal mean functions proportional to a single von Mises density [Koyama et al., 2010].",
      "startOffset" : 227,
      "endOffset" : 248
    }, {
      "referenceID" : 1,
      "context" : "First, motor cortical neurons that have unimodal tuning curves often have narrower peaks that are better described by von Mises distributions [Amirikian and Georgopulos, 2000]. Second, tuning can be multimodal. Third, neural features used for iBCI decoding may capture the pooled activity of several neurons, not just one [Fraser et al., 2009]. While bimodal von Mises models were introduced by Amirikian and Georgopulos [2000], up to now iBCI decoders based on von Mises tuning curves have only employed unimodal mean functions proportional to a single von Mises density [Koyama et al.",
      "startOffset" : 143,
      "endOffset" : 428
    }, {
      "referenceID" : 17,
      "context" : "3) uses a structured latent state representation, sometimes referred to as a dynamic Bayesian network [Murphy, 2002].",
      "startOffset" : 102,
      "endOffset" : 116
    }, {
      "referenceID" : 23,
      "context" : "We relax the first-order Markov assumption via a semi-Markov model of state dynamics [Yu, 2010].",
      "startOffset" : 85,
      "endOffset" : 95
    }, {
      "referenceID" : 13,
      "context" : "Semi-Markov models, introduced by Levy [1954] and Smith [1955], divide the state evolution into contiguous segments.",
      "startOffset" : 34,
      "endOffset" : 46
    }, {
      "referenceID" : 13,
      "context" : "Semi-Markov models, introduced by Levy [1954] and Smith [1955], divide the state evolution into contiguous segments.",
      "startOffset" : 34,
      "endOffset" : 63
    }, {
      "referenceID" : 3,
      "context" : "Right: Illustration of the junction tree used to compute marginals for online decoding, as in Boyen and Koller [1998]. Dashed edges indicate cliques whose potentials depend on the marginal approximations at time t− 1.",
      "startOffset" : 94,
      "endOffset" : 118
    }, {
      "referenceID" : 3,
      "context" : "Efficient decoding is possible via an approximate variant of the junction tree algorithm [Boyen and Koller, 1998].",
      "startOffset" : 89,
      "endOffset" : 113
    }, {
      "referenceID" : 3,
      "context" : "Boyen and Koller [1998] show that this technique has bounded approximation error over time, and Murphy and Weiss [2001] show this as a special case of loopy belief propagation.",
      "startOffset" : 0,
      "endOffset" : 24
    }, {
      "referenceID" : 3,
      "context" : "Boyen and Koller [1998] show that this technique has bounded approximation error over time, and Murphy and Weiss [2001] show this as a special case of loopy belief propagation.",
      "startOffset" : 0,
      "endOffset" : 120
    }, {
      "referenceID" : 10,
      "context" : "“KalmanBC” denotes the Kalman filter with an additional kinematic bias-correction heuristic [Jarosiewicz et al., 2015].",
      "startOffset" : 92,
      "endOffset" : 118
    }, {
      "referenceID" : 10,
      "context" : "Finally, it has been observed that the Kalman decoder is sensitive to outliers for which Jarosiewicz et al. [2015] propose a correction to avoid biased estimates.",
      "startOffset" : 89,
      "endOffset" : 115
    }, {
      "referenceID" : 13,
      "context" : "Right: Two metrics that describe the smoothness of cursor trajectories, introduced by MacKenzie et al. [2001] and commonly used to quantify iBCI performance [Kim et al.",
      "startOffset" : 86,
      "endOffset" : 110
    }, {
      "referenceID" : 10,
      "context" : "As with the Kalman decoding described in Jarosiewicz et al. [2015], we used the Kalman filter in conjunction with a bias correcting postprocessing heuristic.",
      "startOffset" : 41,
      "endOffset" : 67
    }, {
      "referenceID" : 10,
      "context" : "As with the Kalman decoding described in Jarosiewicz et al. [2015], we used the Kalman filter in conjunction with a bias correcting postprocessing heuristic. We used the feature selection method proposed by Malik et al. [2015] to select D = 60 channels of neural data, and used these same 60 channels for both decoders.",
      "startOffset" : 41,
      "endOffset" : 227
    }, {
      "referenceID" : 10,
      "context" : "As with the Kalman decoding described in Jarosiewicz et al. [2015], we used the Kalman filter in conjunction with a bias correcting postprocessing heuristic. We used the feature selection method proposed by Malik et al. [2015] to select D = 60 channels of neural data, and used these same 60 channels for both decoders. Jarosiewicz et al. [2015] selected the timesteps of data to use for parameter learning by taking the first two seconds of each trajectory after a 0.",
      "startOffset" : 41,
      "endOffset" : 346
    }, {
      "referenceID" : 10,
      "context" : "As with the Kalman decoding described in Jarosiewicz et al. [2015], we used the Kalman filter in conjunction with a bias correcting postprocessing heuristic. We used the feature selection method proposed by Malik et al. [2015] to select D = 60 channels of neural data, and used these same 60 channels for both decoders. Jarosiewicz et al. [2015] selected the timesteps of data to use for parameter learning by taking the first two seconds of each trajectory after a 0.3s reaction time. For both decoders, we instead selected all timesteps in which the cursor was a fixed distance from the cued goal because we found this alternative method lead to improvements in offline decoding. Both methods for selecting subsets of the calibration data are designed to compensate for the fact that vectors from cursor to target are not a reliable estimator for participants’ intended aim when the cursor is near the target. Decoding accuracy. Figure 6 shows that our MSSM decoder had less directional error than the configuration of the Kalman filter that we compared to. We confirmed the statistical significance of this result using a Wilcoxon rank sum test. To accommodate the Wilcoxon rank sum test’s independence assumption, we divided the data into individual trajectories from a starting point towards a goal, that ended either when the cursor reached the goal or at a timeout (10 seconds). We then computed the mean squared error of each trajectory, where the squared error is the squared Euclidean distance between the normalized (unit vector) decoded vectors and the unit vectors from cursor to target. Within each session, we compared the distributions of these mean squared errors for trajectories between decoders (p < 10−6 for each session). MSSM also performed better than the Kalman on metrics from MacKenzie et al. [2001] that measure the smoothness of cursor trajectories (see Fig.",
      "startOffset" : 41,
      "endOffset" : 1827
    }, {
      "referenceID" : 21,
      "context" : "This approach to evaluating decoder performance differs from that suggested by Willett et al. [2016], which discusses the possibility of optimizing the speed gain and other decoder parameters to minimize target acquisition time.",
      "startOffset" : 79,
      "endOffset" : 101
    } ],
    "year" : 2017,
    "abstractText" : "Intracortical brain-computer interfaces (iBCIs) have allowed people with tetraplegia to control a computer cursor by imagining the movement of their paralyzed arm or hand. State-of-the-art decoders deployed in human iBCIs are derived from a Kalman filter that assumes Markov dynamics on the angle of intended movement, and a unimodal dependence on intended angle for each channel of neural activity. Due to errors made in the decoding of noisy neural data, as a user attempts to move the cursor to a goal, the angle between cursor and goal positions may change rapidly. We propose a dynamic Bayesian network that includes the on-screen goal position as part of its latent state, and thus allows the person’s intended angle of movement to be aggregated over a much longer history of neural activity. This multiscale model explicitly captures the relationship between instantaneous angles of motion and long-term goals, and incorporates semi-Markov dynamics for motion trajectories. We also introduce a multimodal likelihood model for recordings of neural populations which can be rapidly calibrated for clinical applications. In offline experiments with recorded neural data, we demonstrate significantly improved prediction of motion directions compared to the Kalman filter. We derive an efficient online inference algorithm, enabling a clinical trial participant with tetraplegia to control a computer cursor with neural activity in real time. The observed kinematics of cursor movement are objectively straighter and smoother than prior iBCI decoding models without loss of responsiveness.",
    "creator" : null
  }
}