{
  "name" : "96c5c28becf18e71190460a9955aa4d8.pdf",
  "metadata" : {
    "source" : "META",
    "title" : "Threshold Learning for Optimal Decision Making",
    "authors" : [ "Nathan F. Lepora" ],
    "emails" : [ "n.lepora@bristol.ac.uk" ],
    "sections" : [ {
      "heading" : "1 Introduction",
      "text" : "The standard view of perceptual decision making across psychology and neuroscience is of a competitive process that accumulates sensory evidence for the choices up to a threshold (bound) that triggers the decision [1, 2, 3]. While there is debate about whether humans and animals are ‘optimal’, nonetheless the standard psychological model of this process for two-alternative forced choices (the drift-diffusion model [1]) is a special case of an optimal statistical test for selecting between two hypotheses (the sequential probability ratio test, or SPRT [4]). Formally, this sequential test optimizes a cost function linear in the decision time and type I/II errors averaged over many trials [4]. Thus, under broad assumptions about the decision process, the optimal behaviour is simply to stop gathering data after reaching a threshold independent of the data history and collection time.\nHowever, there remains the problem of how to set these decision thresholds. While there is consensus that an animal tunes its decision making by maximizing mean reward ([3, Chapter 5],[5, 6, 7, 8, 9, 10]), the learning rule is not known. More generally, it is unknown how an animal tunes its propensity towards making choices while also tuning its overall speed-accuracy balance.\nHere we show that optimization of the decision thresholds can be considered as reinforcement learning over single trial rewards derived from Wald’s trial averaged cost function considered previously. However, these single trial rewards are highly stochastic and their average has a broad flat peak (Fig. 1B), constituting a challenging optimization problem that will defeat standard methods. We address this challenge by proposing two distinct ways to learn the decision thresholds, with one approach closer to learning rules from neuroscience and the other to machine learning. The first approach is a learning rule derived from Williams’ REINFORCE algorithm for training neural networks [11], which we here combine with an appropriate policy for controlling the thresholds for optimal decision making. The second is a Bayesian optimization method that fits a Gaussian process to the reward function and samples according to the mean reward and reward variance [12, 13, 14].\nWe find that both methods can successfully learn the thresholds, as validated by comparison against an exhaustive optimization of the reward function. Bayesian optimization converges in fewer trials\n30th Conference on Neural Information Processing Systems (NIPS 2016), Barcelona, Spain.\n(∼102) than REINFORCE (∼103) but is 100-times more computationally expensive with about triple the variance in the threshold estimates. Initial validation is with one decision threshold, corresponding to equal costs of type I/II errors. The methods scale well to two thresholds (unequal costs), and we use REINFORCE to map the full decision performance over both costs. Finally, we compare both methods with experimental two-alternative forced choice data, and find that REINFORCE gives a better account of the acquisition (learning) phase, such as converging over a similar number of trials."
    }, {
      "heading" : "2 Background to the drift-diffusion model and SPRT",
      "text" : "The drift-diffusion model (DDM) of Ratcliff and colleagues is a standard approach for modeling the results of two-alternative forced choice (2AFC) experiments in psychophysics [1, 15]. A decision variable z(t) represents the sensory evidence accumulated to time t from a starting bias z(0) = z0. Discretizing time in uniform steps (assumed integer without losing generality), the update equation is\nz(t+ 1) = z(t) + ∆z, ∆z ∼ N(µ, σ2), (1) where ∆z is the increment of sensory evidence at time t, which is conventionally assumed drawn from a normal distribution N(µ, σ2) of mean µ and variance σ2. The decision criterion is that the accumulated evidence crosses one of two decision thresholds, assumed at −θ0 < 0 < θ1. Wald’s sequential probability ratio test (SPRT) optimally determines whether one of two hypotheses H0, H1 is supported by gathering samples x(t) until a confident decision can be made [4]. It is optimal in that it minimizes the average sample size among all sequential tests to the same error probabilities. The SPRT can be derived from applying Bayes’ rule recursively to sampled data, from when the log posterior ratio log PR(t) passes one of two decision thresholds −θ0 < 0 < θ1:\nlog PR(t+ 1) = log PR(t) + log LR(t), PR(t) = p(H1|x(t)) p(H0|x(t)) , LR(t) = p(x(t)|H1) p(x(t)|H0) , (2)\nbeginning from priors at time zero: PR(0) = p(H1)/p(H0). The right-hand side of equation (2) can also be written as a log likelihood ratio log LR(t) summed over time t (by iterative substitution).\nThe DDM is recognized as a special case of SPRT by setting the likelihoods as two equi-variant Gaussians N(µ1, σ), N(µ0, σ), so that\nlog p(x|H1) p(x|H0) = log e−(x−µ1) 2/2σ2 e−(x−µ0)2/2σ2 = ∆µ σ2 x+ d, ∆µ = µ1 − µ0, d = µ20 − µ21 2σ2 . (3)\nThe integrated evidence z(t) in (1) then coincides with the log posterior ratio in (2) and the increments ∆z with the log likelihood ratio in (2)."
    }, {
      "heading" : "3 Methods to optimize the decision threshold",
      "text" : ""
    }, {
      "heading" : "3.1 Reinforcement learning for optimal decision making",
      "text" : "A general statement of decision optimality can be made in terms of minimizing the Bayes risk [4]. This cost function is linear in the type I and II error probabilities α1 = P (H1|H0) = E1(e) and\nα0 = P (H0|H1) = E0(e), where the decision error e = {0, 1} for correct/incorrect trials, and is also linear in the expected stopping times for each decision outcome 1\nCrisk := 1 2 (W0α0 + cE0[T ]) + 1 2 (W1α1 + cE1[T ]), (4)\nwith type I/II error costs W0,W1 > 0 and cost of time c. That the Bayes risk Crisk has a unique minimum follows from the error probabilities α0, α1 monotonically decreasing and the expected stopping times E0[T ],E1[T ] monotonically increasing with increasing threshold θ0 or θ1. For each pair (W0/c,W1/c), there is thus a unique threshold pair (θ∗0 , θ ∗ 1) that minimizes Crisk.\nWe introduce reward into the formalism by supposing that an application of the SPRT with thresholds (θ0, θ1) has a penalty proportional to the stopping time T and decision outcome\nR = { −W0 − cT, incorrect decision of hypothesis H0 −W1 − cT, incorrect decision of hypothesis H1 −cT, correct decision of hypothesis H0 or H1.\n(5)\nOver many decision trials, the average reward is thus 〈R〉 = −Crisk, the negative of the Bayes risk. Reinforcement learning can then be used to find the optimal thresholds to maximize reward and thus optimize the Bayes risk. Over many trials n = 1, 2, . . . , N with reward R(n), the problem is to estimate these optimal thresholds (θ∗0 , θ ∗ 1) while maintaining minimal regret: the difference between the reward sum of the optimal decision policy and the sum of the collected rewards\nρ(N) = −NCrisk(θ∗0 , θ∗1)− ∑N n=1R(n). (6)\nThis is recognized as a multi-armed bandit problem with a continuous two-dimensional action space parametrized by the threshold pairs (θ0, θ1).\nThe optimization problem of finding the thresholds that maximize mean reward is highly challenging because of the stochastic decision times and errors. Standard approaches such as gradient ascent fail and even state-of-the-art approaches such as cross-entropy or natural evolution strategies are ineffective. A successful approach must combine reward averaging with learning (in a more sophisticated way than batch-averaging or filtering). We now consider two distinct approaches for this."
    }, {
      "heading" : "3.2 REINFORCE method",
      "text" : "The first approach to optimize the decision threshold is a standard 2-factor learning rule derived from Williams’ REINFORCE algorithm for training neural networks [11], but modified to the novel application of continuous bandits. From a modern perspective, the REINFORCE algorithm is seen as an example of a policy gradient method [16, 17]. These are well-suited to reinforcement learning with continuous action spaces, because they use gradient descent to optimize continuously parameterized policies with respect to cumulative reward.\nWe consider the decision thresholds (θ0, θ1) to parametrize actions that correspond to making a single decision with those thresholds. Here we use a policy that expresses the threshold as a linear combination of binary unit outputs, with fixed coefficients specifying the contribution of each unit\nθ0 = ns∑ j=1 sjyj , θ1 = 2ns∑ j=ns+1 sjyj . (7)\nExponential coefficients were found to work well (equivalent to binary encoding), scaled to give a range of thresholds from zero to θmax:\nsj = sns+j = (1/2)j\n1− (1/2)ns θmax, (8)\nwhere here we use ns = 10 units per threshold with maximum threshold θmax = 10. The benefit of this policy (7,8) is that the learning rule can be expressed in terms of the binary unit outputs yj = {0, 1}, which are the variables considered in the REINFORCE learning rule [11]. Following Williams, the policy choosing the threshold on a trial is stochastic by virtue of the binary unit outputs yj = {0, 1} being distributed according to a logistic function of weights wj , such that\nyj ∼ p(yj |wj) = f(wj)yj + (1− f(wj))(1− yj), f(wj) = 1\n1 + e−wj . (9)\n1The full expression has prior probabilities for the frequency of each outcome, which are here assumed equal.\nThe REINFORCE learning rule for these weights is determined by the reward R(n) on trial n\n∆wj = β [yj(t)− f(wj)]R(n), (10)\nwith learning rate β (here generally taken as 0.1). An improvement to the learning rule can be made with reinforcement comparison, with a reference reward R̄(n) = γR(n) + (1− γ)R̄(n− 1) subtracted from R(n); a value γ = 0.5 was found to be effective, and is used in all simulations using the REINFORCE rule in this paper.\nThe power of the REINFORCE learning rule is that the weight change is equal to the gradient of the expected return J(w) = E[R{θ}] over all possible threshold sequences {θ}. Thus, a single-trial learning rule performs like stochastic gradient ascent averaged over many trials. Note also that the neural network input xi of the original formalism [11] is here set to x1 = 1, but a non-trivial input could be used to aid learning recall and generalization (see discussion). Overall, the learning follows a reward-modulated two-factor rule that recruits units distributed according to an exponential size principle, and thus resembles models of biological motor learning."
    }, {
      "heading" : "3.3 Bayesian optimization method",
      "text" : "The second approach is to use Bayesian optimization to find the optimal thresholds from iteratively building a probabilistic model of the reward function that is used to guide future sampling [12, 13, 14]. Bayesian optimization typically uses a Gaussian process model, which provides a nonlinear regression model both of the mean reward and the reward variance with decision threshold. This model can then be used to guide future threshold choice via maximising an acquisition function of these quantities.\nThe basic algorithm for Bayesian optimization is as follows:\nAlgorithm Bayesian optimization applied to optimal decision making for n=1 to N do\nNew thresholds from optimizing acquisition function (θ0, θ1)n = argmax (θ0,θ1) α(θ0, θ1;Dn−1) Make the decision with thresholds (θ0, θ1)n to find reward R(n) Augment data by including new samples Dn = (Dn−1; (θ0, θ1)n, R(n)) Update the statistical (Gaussian process) model of the rewards\nend for\nFollowing other work on Bayesian optimization, we model the reward dependence on the decision thresholds with a Gaussian process\nR(θ0, θ1) ∼ GP[m(θ0, θ1), k(θ0, θ1; θ′0, θ′1)], (11)\nwith mean m(θ0, θ1) = E[R(θ0, θ1)] and covariance modelled by a squared-exponential function\nk(θ0, θ1; θ ′ 0, θ ′ 1) = σ 2 f exp ( −λ2 ||(θ0, θ1)− (θ ′ 0, θ ′ 1)||2 ) . (12)\nThe fitting of the hyperparameters σ2f , λ used standard methods [18] (GPML toolbox and a quasiNewton optimizer in MATLAB). In principle, the two thresholds could each have distinct hyperparameters, but we use one to maintain the symmetry θ0 ↔ θ1 of the decision problem. The choice of decision thresholds is viewed as a sampling problem, and represented by maximizing an acquisition function of the decision thresholds that trades off exploration and exploitation. Here we use the probability of improvement, which guides the sampling towards regions of high uncertainty and reward by maximizing the chance of improving the present best estimate:\n(θ0, θ1)n = argmax (θ0,θ1) α(θ0, θ1), α(θ0, θ1) = Φ\n( m(θ0, θ1)−R(θ∗0 , θ∗1)\nk(θ0, θ1; θ0, θ1)\n) , (13)\nwhere (θ∗0 , θ ∗ 1) are the threshold estimates that have given the greatest reward and Φ is the normal cumulative distribution function. Usually one would include a noise parameter for exploration, but because the decision making is stochastic we use the noise from that process instead.\nDecision accuracyA\nDecision timeB\nRewardC\nDecision thresholdD\nDecision accuracyA\nDecision timeB\nRewardC\nDecision thresholdD"
    }, {
      "heading" : "4 Results",
      "text" : ""
    }, {
      "heading" : "4.1 Single learning episode",
      "text" : "The learning problem is to find the pair of optimal decision thresholds (θ∗0 , θ ∗ 1) that maximize the reward function (5), which is a linear combination of penalties for delays and type I and II errors. The reward function has two free parameters that affect the optimal thresholds: the costs W0/c and W1/c of making type I and II errors relative to time. The methods apply generally, although for concreteness we consider a drift-diffusion model equivalent to the SPRT with distribution means µ0 =−µ1 =1/3 and standard deviation σ = 1. Both the REINFORCE method and Bayesian optimization can converge to approximations of the optimal decision thresholds, as shown in Figures 2D,3D above for a typical learning episode. The decision error e, decision time T and reward R are all highly variable from the stochastic nature of the evidence, although displayed plots have their variance reduced by smoothing over 50 trials (to help interpret the results). There is a gradual convergence towards near optimal decision performance.\nClearly the main difference between the REINFORCE method and the Bayesian optimization method is the speed of convergence to the decision thresholds (c.f. Figures 2D vs 3D). REINFORCE gradually converges over ∼5000 trials whereas Bayesian optimization converges in . 500 trials. However, there are other differences between the two methods that are only revealed for multiple learning episodes, which act to balance the pros and cons across the two methods."
    }, {
      "heading" : "4.2 Multiple learning episodes: one decision threshold",
      "text" : "For validation purposes, we reduce the learning problem to the simpler case where there is only one decision threshold θ0 = θ1, by setting costs equal for type I and II errors W0/c = W1/c so that the error probabilities are equal α0 = α1. This will allow us to compare the two methods in a representative scenario that is simpler to visualize and can be validated against an exhaustive optimization of the reward function (which takes too long to calculate for two thresholds).\nWe consider REINFORCE over 5000 trials and Bayesian optimization over 500 trials, which are sufficient for convergence (Figures 2,3). Costs were considered over a range W/c > 10 via random uniform sampling of c/W over the range [0, 0.1]. Mean decision errors e, decision times T , rewards and thresholds are averaged over the final 50 trials, combining the results for both choices.\nBoth the REINFORCE and Bayesian optimization methods estimate near-optimal decision thresholds for all considered cost parameters (Figures 4,5; red curves) as verified from comparison with an exhaustive search of the reward function (blue curves) over 106 decision trials (randomly sampling the threshold range to estimate an average reward function, as in Fig 1B). In both cases, the exhaustive search lies within one standard deviation of the decision threshold from the two learning methods.\nThere are, however, differences in performance between the two methods. Firstly, the variance of the threshold estimates is greater for Bayesian optimization than for REINFORCE (c.f. Figures 4D vs 5D). The variance of the decision thresholds feeds through into larger variances for the decision error, time and reward. Secondly, although Bayesian optimization converges in fewer trials (500 vs 5000), it comes at the expense of greater computational cost of the algorithm (Table 1).\nThe above results were checked for robustness across reasonable ranges of the various metaparameters for each learning method. For REINFORCE, the results were not appreciably affected by having any learning rate β within the range 0.1-1; similarly, increasing the unit number n did not affect the threshold variances, but scales the computation time."
    }, {
      "heading" : "4.3 Multiple learning episodes: two decision thresholds",
      "text" : "We now consider the learning problem with two decision thresholds (θ0, θ1) that optimize the reward function 5 with differing W0/c and W1/c values. We saw above that REINFORCE produces the more accurate estimates relative to the computational cost, so we concentrate on that method only.\nThe REINFORCE method can find the two decision thresholds (Figure 6), as demonstrated by estimating the thresholds over 2002 instances of the reward function with (c/W0, c/W1) sampled uniformly from [0, 0.1]×[0, 0.1]. Because of the high compute time, we cannot compare the results to those from an exhaustive search, apart from that the plot diagonals (W0/c = W1/c) reduce to the single threshold results which matched an exhaustive optimization (Figure 4).\nFigure 6 is of general interest because it maps the drift-diffusion model (SPRT) decision performance over a main portion of its parameter space. Results for the two decision thresholds (θ0, θ1) are reflections of each other about W0 ↔W1, while the decision error, time and reward are reflection symmetric (consistent with these symmetries of the decision problem). All quantities depend on both weight parameters (W0/c,W1/c) in a smooth but non-trivial manner. To our knowledge, this is the first time the full decision performance has been mapped."
    }, {
      "heading" : "4.4 Comparison with animal learning",
      "text" : "The relation between reward and decision optimality is directly relevant to the psychophysics of two alternative forced choice tasks in the tradeoff between decision accuracy and speed [3]. Multiple studies support that the decision threshold is set to maximize reward [7, 8, 9]. However, the mechanism by which subjects learn the optimal thresholds has not been addressed. Our two learning methods are candidate mechanisms, and thus should be compared with experiment.\nWe have found a couple of studies showing data over the acquisition phase of two-alternative forced choice behavioural experiments: one for rodent whisker vibrotactile discrimination [19, Figure 4] and the other for bat echoacoustic discrimination [20]. Studies detailing the acquisition phase are rare compared to those of the proficient phase, even though they are a necessary component of all such behavioural experiments (and successful studies rest on having a well-designed acquisition phase).\nIn both behavioural studies, the animals acquired proficient decision performance after 5000-10000 trials: in rodent, this was after 25-50 sessions of ∼200 trials [19, Figure 4]; and in bat, after about 6000 trials for naive animals [20, Figure 4]. The typical progress of learning was to begin with random choices (mean decision error e = 0.5) and then gradually converge on the appropriate balance of decision time vs accuracy. There was considerable variance in final performance across different animals (in rodent, mean decision errors were e ∼ 0.05-0.15).\nThat acquisition takes 5000 or more trials is consistent with the REINFORCE learning rule (Figure 2), and not with Bayesian optimization (Figure 3). Moreover, the shape of the acquisition curve for the REINFORCE method resembles that of the animal learning, in also having a good fit to a cumulative Weibull function over a similar number of trials (red line, Figure 2). That being said, the animals begin making random choices and gradually improve in accuracy with longer decision times, whereas both artificial learning methods (Figures 2,3) begin with accurate choices and then decrease in accuracy and decision time. Taken together, this evidence supports that the REINFORCE learning rule is a plausible model of animal learning, although further theoretical and experimental study is required."
    }, {
      "heading" : "5 Discussion",
      "text" : "We examined how to learn decision thresholds in the drift-diffusion model of perceptual decision making. A key step was to use single trial rewards derived from Wald’s trial-averaged cost function for the equivalent sequential probability ratio test, which took the simple form of a linear weighting of penalties due to time and type I/II errors. These highly stochastic rewards are challenging to optimize, which we addressed with two distinct methods to learn the decision thresholds.\nThe first approach for learning the thresholds was based on a method for training neural networks known as Williams’ REINFORCE rule [11]. In modern terminology, this can be viewed as a policy gradient method [16, 17] and here we proposed an appropriate policy for optimal decision making. The second method was a modern Bayesian optimization method that samples and builds a probabilistic model of the reward function to guide further sampling [12, 13, 14]. Both learning methods converged to nearby the optimum decision thresholds, as validated against an exhaustive optimization (over 106 trials). The Bayesian optimization method converged much faster (∼500 trials) than the REINFORCE method (∼5000 trials). However, Bayesian optimization is three-times as variable in the threshold estimates and 40-times slower in computation time. It appears that the faster convergence for Bayesian optimization leads to less averaging over the stochastic rewards, and hence greater variance than with the REINFORCE method.\nWe expect that both the REINFORCE and Bayesian optimization methods used here can be improved to compensate for some of their individual drawbacks. For example, the full REINFORCE learning rule has a third factor corresponding to the neural network input, which could represent a context signal to allow recall and generalization over past learnt thresholds; also, information on past trial performance is discarded by REINFORCE, which could be partially retained to improve learning. Bayesian optimization could be improved in computational speed by updating the Gaussian process with just the new samples after each decision, rather than refitting the entire Gaussian process; also, the variance of the threshold estimates may improve with other choices of acquisition function for sampling the rewards or other assumptions for the Gaussian process covariance function. In addition, the optimization methods may have broader applicability when the optimal decision thresholds vary with time [10], such as tasks with deadlines or when there are multiple (three or more) choices.\nSeveral more factors support the REINFORCE method as a model of reward-driven learning during perceptual decision making. First, REINFORCE is based on a neural network and is thus better suited as a connectionist model of brain function. Second, the REINFORCE model results (Fig. 2) resemble acquisition data from behavioural experiments in rodent [19] and bat [20] (Sec. 4.4). Third, the site of reward learning would plausibly be the basal ganglia, and a similar 3-factor learning rule has already been used to model cortico-striatal plasticity [21]. In addition, multi-alternative (MSPRT) versions of the drift-diffusion model offer a model of action selection in the basal ganglia [22, 23], and so the present REINFORCE model of decision acquisition would extend naturally to encompass a combined model of reinforcement learning and optimal decision making in the brain."
    }, {
      "heading" : "Acknowledgements",
      "text" : "I thank Jack Crago, John Lloyd, Kirsty Aquilina, Kevin Gurney and Giovanni Pezzulo for discussions related to this research. The code used to generate the results and figures for this paper is at http://lepora.com/publications.htm"
    } ],
    "references" : [ {
      "title" : "A theory of memory retrieval",
      "author" : [ "R. Ratcliff" ],
      "venue" : "Psychological Review,",
      "citeRegEx" : "1",
      "shortCiteRegEx" : "1",
      "year" : 1978
    }, {
      "title" : "The neural basis of decision making",
      "author" : [ "J. Gold", "M. Shadlen" ],
      "venue" : "Annu. Rev. Neurosci.,",
      "citeRegEx" : "2",
      "shortCiteRegEx" : "2",
      "year" : 2007
    }, {
      "title" : "The physics of optimal decision making: A formal analysis of models of performance in two-alternative forced-choice tasks",
      "author" : [ "R. Bogacz", "E. Brown", "J. Moehlis", "P. Holmes", "J.D. Cohen" ],
      "venue" : "Psychological Review,",
      "citeRegEx" : "3",
      "shortCiteRegEx" : "3",
      "year" : 2006
    }, {
      "title" : "Optimum character of the sequential probability ratio test",
      "author" : [ "A. Wald", "J. Wolfowitz" ],
      "venue" : "The Annals of Mathematical Statistics,",
      "citeRegEx" : "4",
      "shortCiteRegEx" : "4",
      "year" : 1948
    }, {
      "title" : "Banburismus and the brain: decoding the relationship between sensory stimuli",
      "author" : [ "J. Gold", "M. Shadlen" ],
      "venue" : "decisions, and reward. Neuron,",
      "citeRegEx" : "5",
      "shortCiteRegEx" : "5",
      "year" : 2002
    }, {
      "title" : "Rapid decision threshold modulation by reward rate in a neural network",
      "author" : [ "P. Simen", "J. Cohen", "P. Holmes" ],
      "venue" : "Neural networks,",
      "citeRegEx" : "6",
      "shortCiteRegEx" : "6",
      "year" : 2006
    }, {
      "title" : "Reward rate optimization in twoalternative decision making: empirical tests of theoretical predictions",
      "author" : [ "P. Simen", "D. Contreras", "C. Buck", "P. Hu", "P.J. Holmes", "Cohen" ],
      "venue" : "Journal of Experimental Psychology: Human Perception and Performance,",
      "citeRegEx" : "7",
      "shortCiteRegEx" : "7",
      "year" : 2009
    }, {
      "title" : "Do humans produce the speed–accuracy trade-off that maximizes reward rate",
      "author" : [ "R. Bogacz", "P. Hu", "P. Holmes", "J. Cohen" ],
      "venue" : "The Quarterly Journal of Experimental Psychology,",
      "citeRegEx" : "8",
      "shortCiteRegEx" : "8",
      "year" : 2010
    }, {
      "title" : "Acquisition of decision making criteria: reward rate ultimately beats accuracy",
      "author" : [ "F. Balci", "P. Simen", "R. Niyogi", "A. Saxe", "J. Hughes", "P. Holmes", "J. Cohen" ],
      "venue" : null,
      "citeRegEx" : "9",
      "shortCiteRegEx" : "9",
      "year" : 2011
    }, {
      "title" : "The cost of accumulating evidence in perceptual decision making",
      "author" : [ "J. Drugowitsch", "R. Moreno-Bote", "A. Churchland", "M. Shadlen", "A. Pouget" ],
      "venue" : "The Journal of Neuroscience,",
      "citeRegEx" : "10",
      "shortCiteRegEx" : "10",
      "year" : 2012
    }, {
      "title" : "Simple statistical gradient-following algorithms for connectionist reinforcement learning",
      "author" : [ "R. Williams" ],
      "venue" : "Machine learning,",
      "citeRegEx" : "11",
      "shortCiteRegEx" : "11",
      "year" : 1992
    }, {
      "title" : "Bayesian optimization algorithm. In Hierarchical Bayesian optimization algorithm, pages 31–48",
      "author" : [ "M. Pelikan" ],
      "venue" : null,
      "citeRegEx" : "12",
      "shortCiteRegEx" : "12",
      "year" : 2005
    }, {
      "title" : "A tutorial on bayesian optimization of expensive cost functions, with application to active user modeling and hierarchical reinforcement learning",
      "author" : [ "E. Brochu", "V. Cora", "N. De Freitas" ],
      "venue" : "arXiv preprint arXiv:1012.2599,",
      "citeRegEx" : "13",
      "shortCiteRegEx" : "13",
      "year" : 2010
    }, {
      "title" : "Practical bayesian optimization of machine learning algorithms",
      "author" : [ "J. Snoek", "H. Larochelle", "R. Adams" ],
      "venue" : "In Advances in neural information processing systems,",
      "citeRegEx" : "14",
      "shortCiteRegEx" : "14",
      "year" : 2012
    }, {
      "title" : "The diffusion decision model: theory and data for two-choice decision tasks",
      "author" : [ "R. Ratcliff", "G. McKoon" ],
      "venue" : "Neural computation,",
      "citeRegEx" : "15",
      "shortCiteRegEx" : "15",
      "year" : 2008
    }, {
      "title" : "Reinforcement learning of motor skills with policy gradients",
      "author" : [ "J. Peters", "S. Schaal" ],
      "venue" : "Neural networks,",
      "citeRegEx" : "16",
      "shortCiteRegEx" : "16",
      "year" : 2008
    }, {
      "title" : "Policy gradient methods for reinforcement learning with function approximation",
      "author" : [ "R. Sutton", "D. McAllester", "S. Singh", "Y. Mansour" ],
      "venue" : "In Neural Information Processing Systems",
      "citeRegEx" : "17",
      "shortCiteRegEx" : "17",
      "year" : 2000
    }, {
      "title" : "Gaussian Processes for Machine Learning",
      "author" : [ "C. Rasmussen", "C. Williams" ],
      "venue" : null,
      "citeRegEx" : "18",
      "shortCiteRegEx" : "18",
      "year" : 2006
    }, {
      "title" : "Novel two-alternative forced choice paradigm for bilateral vibrotactile whisker frequency discrimination in head-fixed mice and rats",
      "author" : [ "J. Mayrhofer", "V. Skreb", "W. von der Behrens", "S. Musall", "B. Weber", "F. Haiss" ],
      "venue" : "Journal of neurophysiology,",
      "citeRegEx" : "19",
      "shortCiteRegEx" : "19",
      "year" : 2013
    }, {
      "title" : "Lack of generalization of object discrimination between spatial contexts by a bat",
      "author" : [ "K. Stich", "Y. Winter" ],
      "venue" : "Journal of experimental biology,",
      "citeRegEx" : "20",
      "shortCiteRegEx" : "20",
      "year" : 2006
    }, {
      "title" : "Anatomy of a decision: striato-orbitofrontal interactions in reinforcement learning, decision making, and reversal",
      "author" : [ "M. Frank", "E. Claus" ],
      "venue" : "Psychological review,",
      "citeRegEx" : "21",
      "shortCiteRegEx" : "21",
      "year" : 2006
    }, {
      "title" : "The basal ganglia and cortex implement optimal decision making between alternative actions",
      "author" : [ "R. Bogacz", "K. Gurney" ],
      "venue" : "Neural computation,",
      "citeRegEx" : "22",
      "shortCiteRegEx" : "22",
      "year" : 2007
    }, {
      "title" : "The basal ganglia optimize decision making over general perceptual hypotheses",
      "author" : [ "N. Lepora", "K. Gurney" ],
      "venue" : "Neural Computation,",
      "citeRegEx" : "23",
      "shortCiteRegEx" : "23",
      "year" : 2012
    } ],
    "referenceMentions" : [ {
      "referenceID" : 0,
      "context" : "The standard view of perceptual decision making across psychology and neuroscience is of a competitive process that accumulates sensory evidence for the choices up to a threshold (bound) that triggers the decision [1, 2, 3].",
      "startOffset" : 214,
      "endOffset" : 223
    }, {
      "referenceID" : 1,
      "context" : "The standard view of perceptual decision making across psychology and neuroscience is of a competitive process that accumulates sensory evidence for the choices up to a threshold (bound) that triggers the decision [1, 2, 3].",
      "startOffset" : 214,
      "endOffset" : 223
    }, {
      "referenceID" : 2,
      "context" : "The standard view of perceptual decision making across psychology and neuroscience is of a competitive process that accumulates sensory evidence for the choices up to a threshold (bound) that triggers the decision [1, 2, 3].",
      "startOffset" : 214,
      "endOffset" : 223
    }, {
      "referenceID" : 0,
      "context" : "While there is debate about whether humans and animals are ‘optimal’, nonetheless the standard psychological model of this process for two-alternative forced choices (the drift-diffusion model [1]) is a special case of an optimal statistical test for selecting between two hypotheses (the sequential probability ratio test, or SPRT [4]).",
      "startOffset" : 193,
      "endOffset" : 196
    }, {
      "referenceID" : 3,
      "context" : "While there is debate about whether humans and animals are ‘optimal’, nonetheless the standard psychological model of this process for two-alternative forced choices (the drift-diffusion model [1]) is a special case of an optimal statistical test for selecting between two hypotheses (the sequential probability ratio test, or SPRT [4]).",
      "startOffset" : 332,
      "endOffset" : 335
    }, {
      "referenceID" : 3,
      "context" : "Formally, this sequential test optimizes a cost function linear in the decision time and type I/II errors averaged over many trials [4].",
      "startOffset" : 132,
      "endOffset" : 135
    }, {
      "referenceID" : 4,
      "context" : "While there is consensus that an animal tunes its decision making by maximizing mean reward ([3, Chapter 5],[5, 6, 7, 8, 9, 10]), the learning rule is not known.",
      "startOffset" : 108,
      "endOffset" : 127
    }, {
      "referenceID" : 5,
      "context" : "While there is consensus that an animal tunes its decision making by maximizing mean reward ([3, Chapter 5],[5, 6, 7, 8, 9, 10]), the learning rule is not known.",
      "startOffset" : 108,
      "endOffset" : 127
    }, {
      "referenceID" : 6,
      "context" : "While there is consensus that an animal tunes its decision making by maximizing mean reward ([3, Chapter 5],[5, 6, 7, 8, 9, 10]), the learning rule is not known.",
      "startOffset" : 108,
      "endOffset" : 127
    }, {
      "referenceID" : 7,
      "context" : "While there is consensus that an animal tunes its decision making by maximizing mean reward ([3, Chapter 5],[5, 6, 7, 8, 9, 10]), the learning rule is not known.",
      "startOffset" : 108,
      "endOffset" : 127
    }, {
      "referenceID" : 8,
      "context" : "While there is consensus that an animal tunes its decision making by maximizing mean reward ([3, Chapter 5],[5, 6, 7, 8, 9, 10]), the learning rule is not known.",
      "startOffset" : 108,
      "endOffset" : 127
    }, {
      "referenceID" : 9,
      "context" : "While there is consensus that an animal tunes its decision making by maximizing mean reward ([3, Chapter 5],[5, 6, 7, 8, 9, 10]), the learning rule is not known.",
      "startOffset" : 108,
      "endOffset" : 127
    }, {
      "referenceID" : 10,
      "context" : "The first approach is a learning rule derived from Williams’ REINFORCE algorithm for training neural networks [11], which we here combine with an appropriate policy for controlling the thresholds for optimal decision making.",
      "startOffset" : 110,
      "endOffset" : 114
    }, {
      "referenceID" : 11,
      "context" : "The second is a Bayesian optimization method that fits a Gaussian process to the reward function and samples according to the mean reward and reward variance [12, 13, 14].",
      "startOffset" : 158,
      "endOffset" : 170
    }, {
      "referenceID" : 12,
      "context" : "The second is a Bayesian optimization method that fits a Gaussian process to the reward function and samples according to the mean reward and reward variance [12, 13, 14].",
      "startOffset" : 158,
      "endOffset" : 170
    }, {
      "referenceID" : 13,
      "context" : "The second is a Bayesian optimization method that fits a Gaussian process to the reward function and samples according to the mean reward and reward variance [12, 13, 14].",
      "startOffset" : 158,
      "endOffset" : 170
    }, {
      "referenceID" : 0,
      "context" : "The drift-diffusion model (DDM) of Ratcliff and colleagues is a standard approach for modeling the results of two-alternative forced choice (2AFC) experiments in psychophysics [1, 15].",
      "startOffset" : 176,
      "endOffset" : 183
    }, {
      "referenceID" : 14,
      "context" : "The drift-diffusion model (DDM) of Ratcliff and colleagues is a standard approach for modeling the results of two-alternative forced choice (2AFC) experiments in psychophysics [1, 15].",
      "startOffset" : 176,
      "endOffset" : 183
    }, {
      "referenceID" : 3,
      "context" : "Wald’s sequential probability ratio test (SPRT) optimally determines whether one of two hypotheses H0, H1 is supported by gathering samples x(t) until a confident decision can be made [4].",
      "startOffset" : 184,
      "endOffset" : 187
    }, {
      "referenceID" : 3,
      "context" : "1 Reinforcement learning for optimal decision making A general statement of decision optimality can be made in terms of minimizing the Bayes risk [4].",
      "startOffset" : 146,
      "endOffset" : 149
    }, {
      "referenceID" : 10,
      "context" : "2 REINFORCE method The first approach to optimize the decision threshold is a standard 2-factor learning rule derived from Williams’ REINFORCE algorithm for training neural networks [11], but modified to the novel application of continuous bandits.",
      "startOffset" : 182,
      "endOffset" : 186
    }, {
      "referenceID" : 15,
      "context" : "From a modern perspective, the REINFORCE algorithm is seen as an example of a policy gradient method [16, 17].",
      "startOffset" : 101,
      "endOffset" : 109
    }, {
      "referenceID" : 16,
      "context" : "From a modern perspective, the REINFORCE algorithm is seen as an example of a policy gradient method [16, 17].",
      "startOffset" : 101,
      "endOffset" : 109
    }, {
      "referenceID" : 10,
      "context" : "The benefit of this policy (7,8) is that the learning rule can be expressed in terms of the binary unit outputs yj = {0, 1}, which are the variables considered in the REINFORCE learning rule [11].",
      "startOffset" : 191,
      "endOffset" : 195
    }, {
      "referenceID" : 10,
      "context" : "Note also that the neural network input xi of the original formalism [11] is here set to x1 = 1, but a non-trivial input could be used to aid learning recall and generalization (see discussion).",
      "startOffset" : 69,
      "endOffset" : 73
    }, {
      "referenceID" : 11,
      "context" : "3 Bayesian optimization method The second approach is to use Bayesian optimization to find the optimal thresholds from iteratively building a probabilistic model of the reward function that is used to guide future sampling [12, 13, 14].",
      "startOffset" : 223,
      "endOffset" : 235
    }, {
      "referenceID" : 12,
      "context" : "3 Bayesian optimization method The second approach is to use Bayesian optimization to find the optimal thresholds from iteratively building a probabilistic model of the reward function that is used to guide future sampling [12, 13, 14].",
      "startOffset" : 223,
      "endOffset" : 235
    }, {
      "referenceID" : 13,
      "context" : "3 Bayesian optimization method The second approach is to use Bayesian optimization to find the optimal thresholds from iteratively building a probabilistic model of the reward function that is used to guide future sampling [12, 13, 14].",
      "startOffset" : 223,
      "endOffset" : 235
    }, {
      "referenceID" : 17,
      "context" : "The fitting of the hyperparameters σ(2) f , λ used standard methods [18] (GPML toolbox and a quasiNewton optimizer in MATLAB).",
      "startOffset" : 68,
      "endOffset" : 72
    }, {
      "referenceID" : 2,
      "context" : "The relation between reward and decision optimality is directly relevant to the psychophysics of two alternative forced choice tasks in the tradeoff between decision accuracy and speed [3].",
      "startOffset" : 185,
      "endOffset" : 188
    }, {
      "referenceID" : 6,
      "context" : "Multiple studies support that the decision threshold is set to maximize reward [7, 8, 9].",
      "startOffset" : 79,
      "endOffset" : 88
    }, {
      "referenceID" : 7,
      "context" : "Multiple studies support that the decision threshold is set to maximize reward [7, 8, 9].",
      "startOffset" : 79,
      "endOffset" : 88
    }, {
      "referenceID" : 8,
      "context" : "Multiple studies support that the decision threshold is set to maximize reward [7, 8, 9].",
      "startOffset" : 79,
      "endOffset" : 88
    }, {
      "referenceID" : 19,
      "context" : "We have found a couple of studies showing data over the acquisition phase of two-alternative forced choice behavioural experiments: one for rodent whisker vibrotactile discrimination [19, Figure 4] and the other for bat echoacoustic discrimination [20].",
      "startOffset" : 248,
      "endOffset" : 252
    }, {
      "referenceID" : 10,
      "context" : "The first approach for learning the thresholds was based on a method for training neural networks known as Williams’ REINFORCE rule [11].",
      "startOffset" : 132,
      "endOffset" : 136
    }, {
      "referenceID" : 15,
      "context" : "In modern terminology, this can be viewed as a policy gradient method [16, 17] and here we proposed an appropriate policy for optimal decision making.",
      "startOffset" : 70,
      "endOffset" : 78
    }, {
      "referenceID" : 16,
      "context" : "In modern terminology, this can be viewed as a policy gradient method [16, 17] and here we proposed an appropriate policy for optimal decision making.",
      "startOffset" : 70,
      "endOffset" : 78
    }, {
      "referenceID" : 11,
      "context" : "The second method was a modern Bayesian optimization method that samples and builds a probabilistic model of the reward function to guide further sampling [12, 13, 14].",
      "startOffset" : 155,
      "endOffset" : 167
    }, {
      "referenceID" : 12,
      "context" : "The second method was a modern Bayesian optimization method that samples and builds a probabilistic model of the reward function to guide further sampling [12, 13, 14].",
      "startOffset" : 155,
      "endOffset" : 167
    }, {
      "referenceID" : 13,
      "context" : "The second method was a modern Bayesian optimization method that samples and builds a probabilistic model of the reward function to guide further sampling [12, 13, 14].",
      "startOffset" : 155,
      "endOffset" : 167
    }, {
      "referenceID" : 9,
      "context" : "In addition, the optimization methods may have broader applicability when the optimal decision thresholds vary with time [10], such as tasks with deadlines or when there are multiple (three or more) choices.",
      "startOffset" : 121,
      "endOffset" : 125
    }, {
      "referenceID" : 18,
      "context" : "2) resemble acquisition data from behavioural experiments in rodent [19] and bat [20] (Sec.",
      "startOffset" : 68,
      "endOffset" : 72
    }, {
      "referenceID" : 19,
      "context" : "2) resemble acquisition data from behavioural experiments in rodent [19] and bat [20] (Sec.",
      "startOffset" : 81,
      "endOffset" : 85
    }, {
      "referenceID" : 20,
      "context" : "Third, the site of reward learning would plausibly be the basal ganglia, and a similar 3-factor learning rule has already been used to model cortico-striatal plasticity [21].",
      "startOffset" : 169,
      "endOffset" : 173
    }, {
      "referenceID" : 21,
      "context" : "In addition, multi-alternative (MSPRT) versions of the drift-diffusion model offer a model of action selection in the basal ganglia [22, 23], and so the present REINFORCE model of decision acquisition would extend naturally to encompass a combined model of reinforcement learning and optimal decision making in the brain.",
      "startOffset" : 132,
      "endOffset" : 140
    }, {
      "referenceID" : 22,
      "context" : "In addition, multi-alternative (MSPRT) versions of the drift-diffusion model offer a model of action selection in the basal ganglia [22, 23], and so the present REINFORCE model of decision acquisition would extend naturally to encompass a combined model of reinforcement learning and optimal decision making in the brain.",
      "startOffset" : 132,
      "endOffset" : 140
    } ],
    "year" : 2016,
    "abstractText" : "Decision making under uncertainty is commonly modelled as a process of competitive stochastic evidence accumulation to threshold (the drift-diffusion model). However, it is unknown how animals learn these decision thresholds. We examine threshold learning by constructing a reward function that averages over many trials to Wald’s cost function that defines decision optimality. These rewards are highly stochastic and hence challenging to optimize, which we address in two ways: first, a simple two-factor reward-modulated learning rule derived from Williams’ REINFORCE method for neural networks; and second, Bayesian optimization of the reward function with a Gaussian process. Bayesian optimization converges in fewer trials than REINFORCE but is slower computationally with greater variance. The REINFORCE method is also a better model of acquisition behaviour in animals and a similar learning rule has been proposed for modelling basal ganglia function.",
    "creator" : null
  }
}