{"title": "Reflection, Refraction, and Hamiltonian Monte Carlo", "abstract": "Hamiltonian Monte Carlo (HMC) is a successful approach for sampling from continuous densities. However, it has difficulty simulating Hamiltonian dynamics with non-smooth functions, leading to poor performance. This paper is motivated by the behavior of Hamiltonian dynamics in physical systems like optics. We introduce a modification of the Leapfrog discretization of Hamiltonian dynamics on piecewise continuous energies, where intersections of the trajectory with discontinuities are detected, and the momentum is reflected or refracted to compensate for the change in energy. We prove that this method preserves the correct stationary distribution when boundaries are affine. Experiments show that by reducing the number of rejected samples, this method improves on traditional HMC.", "id": "8303a79b1e19a194f1875981be5bdb6f", "authors": ["Hadi Mohasel Afshar", "Justin Domke"], "conference": "NIPS2015", "accepted": true, "reviews": [{"comments": "SUMMARY\n\n Hamiltonian MCMC methods sample from a probability\n\n distribution by treating its log as a \"potential energy\"\n\n function over the state space, augmenting the space with extra\n\n \"momentum variables\" and their associated \"kinetic energy\",\n\n and evolving the state of the Markov process by integrating\n\n the physical Hamiltonian equations of motion of the system.\n\n Each step of the Markov chain is accomplished by numerically\n\n integrating the Hamiltonian equations forward in time.\n\n However, if the energy function is non-differentiable, the\n\n integral is not well-defined.\n\nThe rejection step that is used\n\n to counteract numerical inaccuracies in the integration also\n\n accounts for such non-differentiable regions, but at the cost\n\n of slowing down the mixing rate of the Markov chain.\n\nThis\n\n paper suggests physically-inspired \"reflections\" and\n\n \"refractions\" of the trajectory of the system that occur\n\n whenever the state crosses a discontinuity in the energy\n\n function.\n\nIt applies to target distributions that are\n\n differentiable everywhere except on the boundaries of certain\n\n polytopes; the reflection or refraction occurs whenever the\n\n trajectory of the system crosses such a boundary.\n\n Whether a reflection or refraction occurs depends on if the\n\n momentum component of the state is sufficient to \"climb\" the\n\n gap in energy.\n\nThe authors show that the necessary\n\n volume-preservation properties are satisfied by these\n\n reflection and refraction procedures, so that the Markov\n\n chains converges to the required target distribution.\n\n QUALITY\n\n The presented modification to Hamiltonian MCMC is useful and\n\n the case of piecewise-differentiable target distributions is\n\n quite applicable in practice.\n\nIt would, of course, be useful\n\n to have boundaries that are not affine hyperplanes.\n\n CLARITY\n\n The algorithm, its motivation, and the proof of the volume\n\n preservation property is clearly presented.\n\nSome more\n\n (qualitative and/or quantitative) discussion about how the\n\n reflections and refractions affect rejection rates would be\n\n useful.\n\n ORIGINALITY AND SIGNIFICANCE\n\n The idea of applying physically-based reflection and\n\n refraction to Hamiltonian MCMC methods appears to be novel and\n\n useful.\n\nWhile the present work proves its correctness under\n\n certain conditions, it is an interesting avenue of research to\n\n extend it further.\n\n  A modification of Hamiltonian MCMC is presented tohandle probability distributions that are not differentiable onthe boundaries of polytopes.The proposed solution is for thetrajectory of the system to be reflected or refracted when itencounters such a boundary, thereby reducing rejection rates andimproving mixing speed.", "IS_ANNOTATED": false, "IS_META_REVIEW": false}, {"comments": "This paper presents and verifies (correctness and performance through simulation) a sensible variation on HMC for pdfs with discontinuities or on a bounded domain.\n\nThe method relies on simulating refraction and reflection that result from hamiltonian dynamics, so leads to better proposals around discontinuities (and higher acceptance rates => higher ess).\n\n One thing that would be nice is to see an example of a pdf when it's not worth computing intersections.\n\nWhat types of high dimensional pdfs is this method not suited for?  This paper presents and verifies", "IS_ANNOTATED": false, "IS_META_REVIEW": false}, {"comments": "This is an interesting extension of the standard case and the proof of volume conservation presented is simple but important and was lacking in previous works. The writing is clear.\n\n Typos: l.161:\n\n\",Then\" l.376: \"parameters, are tuned\"  This paper extends the leapfrog discretization used in Hamiltonian Monte Carlo to piecewise smooth distributions. The algorithm is correct and is an interesting extension of the smooth case.", "IS_ANNOTATED": false, "IS_META_REVIEW": false}, {"comments": "UPDATES AFTER REBUTTAL: Thank you for addressing my questions. The extra numerical results in the supplement are a welcome addition to the paper. I think that this is a good paper, but I will keep my score at 7.\n\nORIGINAL REVIEW: The paper proposes a modified leapfrog integrator for Hamiltonian Monte Carlo for sampling from piecewise continuous probability distributions, with affine discontinuity boundaries. The simulator makes use of reflection and refraction of the simulated trajectory whenever it hits a boundary. Similar ideas have previously been used for simulating from multivariate Gaussian distributions with constraints, but as far as I can tell this is the first application of this approach to \"general\" distributions (although, I'm not an expert on HMC). The idea is simple but intuitively appealing (most good ideas are simple!) and I think that this method can be very useful for a restricted class of problems. The numerical evaluation is not very extensive and the authors should consider extending it for a later (re)submission. Furthermore, there are several typos that need to be corrected.\n\nFinally, can you comment on the possibility of using non-affine discontinuity boundaries? Apart from the computational issues associated with computing intersections, would it be possible to extend the approach to allow for more general boundaries?\n\nSome detailed comments/questions:\n\n- In section 3: in think that it could be useful to mention that K(p') = K(p) - \\Delta U to explain the form of the refracted momentum. - In Equation (3): aren't the upper triangle (excluding the four elements in the upper left corner) also zero? - Line 363: Missing normalisation by k in the definition of WMAE. - Footnote 2 on page 7: I think that it would be good if you could elaborate on the sensitivity of the tuning parameters (L and eps) of your method to convince the reader. Perhaps include additional numerical result in a supplementary material?  The paper proposes a modified leapfrog integrator for Hamiltonian Monte Carlo for sampling from piecewise continuous probability distributions, with affine discontinuity boundaries. The idea is simple but potentially very useful for a restricted class of problems. The numerical evaluation is not very extensive.", "IS_ANNOTATED": false, "IS_META_REVIEW": false}], "histories": []}
