{
  "name" : "f3bd5ad57c8389a8a1a541a76be463bf.pdf",
  "metadata" : {
    "source" : "META",
    "title" : "Stochastic Expectation Propagation",
    "authors" : [ "Yingzhen Li", "José Miguel Hernández-Lobato" ],
    "emails" : [ "yl494@cam.ac.uk", "jmh@seas.harvard.edu", "ret26@cam.ac.uk" ],
    "sections" : [ {
      "heading" : "1 Introduction",
      "text" : "Recently a number of methods have been developed for applying Bayesian learning to large datasets. Examples include sampling approximations [1, 2], distributional approximations including stochastic variational inference (SVI) [3] and assumed density filtering (ADF) [4], and approaches that mix distributional and sampling approximations [5, 6]. One family of approximation method has garnered less attention in this regard: Expectation Propagation (EP) [7, 8]. EP constructs a posterior approximation by iterating simple local computations that refine factors which approximate the posterior contribution from each datapoint. At first sight, it therefore appears well suited to large-data problems: the locality of computation make the algorithm simple to parallelise and distribute, and good practical performance on a range of small data applications suggest that it will be accurate [9, 10, 11]. However the elegance of local computation has been bought at the price of prohibitive memory overhead that grows with the number of datapoints N , since local approximating factors need to be maintained for every datapoint, which typically incur the same memory overhead as the global approximation. The same pathology exists for the broader class of power EP (PEP) algorithms [12] that includes variational message passing [13]. In contrast, variational inference (VI) methods [14, 15] utilise global approximations that are refined directly, which prevents memory overheads from scaling with N .\nIs there ever a case for preferring EP (or PEP) to VI methods for large data? We believe that there certainly is. First, EP can provide significantly more accurate approximations. It is well known that variational free-energy approaches are biased and often severely so [16] and for particular models the variational free-energy objective is pathologically ill-suited such as those with non-smooth likelihood functions [11, 17]. Second, the fact that EP is truly local (to factors in the posterior distri-\nbution and not just likelihoods) means that it affords different opportunities for tractable algorithm design, as the updates can be simpler to approximate.\nAs EP appears to be the method of choice for some applications, researchers have attempted to push it to scale. One approach is to swallow the large computational burden and simply use large data structures to store the approximating factors (e.g. TrueSkill [18]). This approach can only be pushed so far. A second approach is to use ADF, a simple variant of EP that only requires a global approximation to be maintained in memory [19]. ADF, however, provides poorly calibrated uncertainty estimates [7] which was one of the main motivating reasons for developing EP in the first place. A third idea, complementary to the one described here, is to use approximating factors that have simpler structure (e.g. low rank, [20]). This reduces memory consumption (e.g. for Gaussian factors from O(ND2) to O(ND)), but does not stop the scaling with N . Another idea uses EP to carve up the dataset [5, 6] using approximating factors for collections of datapoints. This results in coarse-grained, rather than local, updates and other methods must be used to compute them. (Indeed, the spirit of [5, 6] is to extend sampling methods to large datasets, not EP itself.)\nCan we have the best of both worlds? That is, accurate global approximations that are derived from truly local computation. To address this question we develop an algorithm based upon the standard EP and ADF algorithms that maintains a global approximation which is updated in a local way. We call this class of algorithms Stochastic Expectation Propagation (SEP) since it updates the global approximation with (damped) stochastic estimates on data sub-samples in an analogous way to SVI. Indeed, the generalisation of the algorithm to the PEP setting directly relates to SVI. Importantly, SEP reduces the memory footprint by a factor of N when compared to EP. We further extend the method to control the granularity of the approximation, and to treat models with latent variables without compromising on accuracy or unnecessary memory demands. Finally, we demonstrate the scalability and accuracy of the method on a number of real world and synthetic datasets."
    }, {
      "heading" : "2 Expectation Propagation and Assumed Density Filtering",
      "text" : "We begin by briefly reviewing the EP and ADF algorithms upon which our new method is based. Consider for simplicity observing a dataset comprising N i.i.d. samples D = {xn}Nn=1 from a probabilistic model p(x|θ) parametrised by an unknownD-dimensional vector θ that is drawn from a prior p0(θ). Exact Bayesian inference involves computing the (typically intractable) posterior distribution of the parameters given the data,\np(θ|D) ∝ p0(θ) N∏ n=1 p(xn|θ) ≈ q(θ) ∝ p0(θ) N∏ n=1 fn(θ). (1)\nHere q(θ) is a simpler tractable approximating distribution that will be refined by EP. The goal of EP is to refine the approximate factors so that they capture the contribution of each of the likelihood terms to the posterior i.e. fn(θ) ≈ p(xn|θ). In this spirit, one approach would be to find each approximating factor fn(θ) by minimising the Kullback-Leibler (KL) divergence between the posterior and the distribution formed by replacing one of the likelihoods by its corresponding approximating factor, KL[p(θ|D)||p(θ|D)fn(θ)/p(xn|θ)]. Unfortunately, such an update is still intractable as it involves computing the full posterior. Instead, EP approximates this procedure by replacing the exact leave-one-out posterior p−n(θ) ∝ p(θ|D)/p(xn|θ) on both sides of the KL by the approximate leave-one-out posterior (called the cavity distribution) q−n(θ) ∝ q(θ)/fn(θ). Since this couples the updates for the approximating factors, the updates must now be iterated.\nIn more detail, EP iterates four simple steps. First, the factor selected for update is removed from the approximation to produce the cavity distribution. Second, the corresponding likelihood is included to produce the tilted distribution p̃n(θ) ∝ q−n(θ)p(xn|θ). Third EP updates the approximating factor by minimising KL[p̃n(θ)||q−n(θ)fn(θ)]. The hope is that the contribution the true-likelihood makes to the posterior is similar to the effect the same likelihood has on the tilted distribution. If the approximating distribution is in the exponential family, as is often the case, then the KL minimisation reduces to a moment matching step [21] that we denote fn(θ) ← proj[p̃n(θ)]/q−n(θ). Finally, having updated the factor, it is included into the approximating distribution.\nWe summarise the update procedure for a single factor in Algorithm 1. Critically, the approximation step of EP involves local computations since one likelihood term is treated at a time. The assumption\nAlgorithm 1 EP 1: choose a factor fn to refine: 2: compute cavity distribution\nAlgorithm 2 ADF 1: choose a datapoint xn ∼ D: 2: compute cavity distribution\nAlgorithm 3 SEP 1: choose a datapoint xn ∼ D: 2: compute cavity distribution\nis that these local computations, although possibly requiring further approximation, are far simpler to handle compared to the full posterior p(θ|D). In practice, EP often performs well when the updates are parallelised. Moreover, by using approximating factors for groups of datapoints, and then running additional approximate inference algorithms to perform the EP updates (which could include nesting EP), EP carves up the data making it suitable for distributed approximate inference.\nThere is, however, one wrinkle that complicates deployment of EP at scale. Computation of the cavity distribution requires removal of the current approximating factor, which means any implementation of EP must store them explicitly necessitating an O(N) memory footprint. One option is to simply ignore the removal step replacing the cavity distribution with the full approximation, resulting in the ADF algorithm (Algorithm 2) that needs only maintain a global approximation in memory. But as the moment matching step now over-counts the underlying approximating factor (consider the new form of the objective KL[q(θ)p(xn|θ)||q(θ)]) the variance of the approximation shrinks to zero as multiple passes are made through the dataset. Early stopping is therefore required to prevent overfitting and generally speaking ADF does not return uncertainties that are well-calibrated to the posterior. In the next section we introduce a new algorithm that sidesteps EP’s large memory demands whilst avoiding the pathological behaviour of ADF."
    }, {
      "heading" : "3 Stochastic Expectation Propagation",
      "text" : "In this section we introduce a new algorithm, inspired by EP, called Stochastic Expectation Propagation (SEP) that combines the benefits of local approximation (tractability of updates, distributability, and parallelisability) with global approximation (reduced memory demands). The algorithm can be interpreted as a version of EP in which the approximating factors are tied, or alternatively as a corrected version of ADF that prevents overfitting. The key idea is that, at convergence, the approximating factors in EP can be interpreted as parameterising a global factor, f(θ), that captures the average effect of a likelihood on the posterior f(θ)N 4 = ∏N n=1 fn(θ) ≈ ∏N n=1 p(xn|θ). In this spirit, the new algorithm employs direct iterative refinement of a global approximation comprising the prior and N copies of a single approximating factor, f(θ), that is q(θ) ∝ f(θ)Np0(θ). SEP uses updates that are analogous to EP’s in order to refine f(θ) in such a way that it captures the average effect a likelihood function has on the posterior. First the cavity distribution is formed by removing one of the copies of the factor, q−1(θ) ∝ q(θ)/f(θ). Second, the corresponding likelihood is included to produce the tilted distribution p̃n(θ) ∝ q−1(θ)p(xn|θ) and, third, SEP finds an intermediate factor approximation by moment matching, fn(θ) ← proj[p̃n(θ)]/q−1(θ). Finally, having updated the factor, it is included into the approximating distribution. It is important here not to make a full update since fn(θ) captures the effect of just a single likelihood function p(xn|θ). Instead, damping should be employed to make a partial update f(θ) ← f(θ)1− fn(θ) . A natural choice uses = 1/N which can be interpreted as minimising KL[p̃n(θ)||p0(θ)f(θ)N ]\nin the moment update, but other choices of may be more appropriate, including decreasing according to the Robbins-Monro condition [22].\nSEP is summarised in Algorithm 3. Unlike ADF, the cavity is formed by dividing out f(θ) which captures the average affect of the likelihood and prevents the posterior from collapsing. Like ADF, however, SEP only maintains the global approximation q(θ) since f(θ) ∝ (q(θ)/p0(θ)) 1 N and q−1(θ) ∝ q(θ)1− 1 N p0(θ) 1 N . When Gaussian approximating factors are used, for example, SEP reduces the storage requirement of EP from O(ND2) to O(D2) which is a substantial saving that enables models with many parameters to be applied to large datasets."
    }, {
      "heading" : "4 Algorithmic extensions to SEP and theoretical results",
      "text" : "SEP has been motivated from a practical perspective by the limitations inherent in EP and ADF. In this section we extend SEP in four orthogonal directions relate SEP to SVI. Many of the algorithms described here are summarised in Figure 2 and they are detailed in the supplementary material."
    }, {
      "heading" : "4.1 Parallel SEP: relating the EP fixed points to SEP",
      "text" : "The SEP algorithm outlined above approximates one likelihood at a time which can be computationally slow. However, it is simple to parallelise the SEP updates by following the same recipe by which EP is parallelised. Consider a minibatch comprising M datapoints (for a full parallel batch update use M = N ). First we form the cavity distribution for each likelihood. Unlike EP these are all identical. Next, in parallel, compute M intermediate factors fm(θ) ← proj[p̃m(θ)]/q−1(θ). In EP these intermediate factors become the new likelihood approximations and the approximation is updated to q(θ) = p0(θ) ∏ n 6=m fn(θ) ∏ m fm(θ). In SEP, the same update is used for\nthe approximating distribution, which becomes q(θ) ← p0(θ)fold(θ)N−M ∏ m fm(θ) and, by im-\nplication, the approximating factor is fnew(θ) = fold(θ)1−M/N ∏M m=1 fm(θ)\n1/N . One way of understanding parallel SEP is as a double loop algorithm. The inner loop produces intermediate approximations qm(θ) ← arg minq KL[p̃m(θ)||q(θ)]; these are then combined in the outer loop: q(θ)← arg minq ∑M m=1 KL[q(θ)||qm(θ)] + (N −M)KL[q(θ)||qold(θ)].\nFor M = 1 parallel SEP reduces to the original SEP algorithm. For M = N parallel SEP is equivalent to the so-called Averaged EP algorithm proposed in [23] as a theoretical tool to study the convergence properties of normal EP. This work showed that, under fairly restrictive conditions (likelihood functions that are log-concave and varying slowly as a function of the parameters), AEP converges to the same fixed points as EP in the large data limit (N →∞). There is another illuminating connection between SEP and AEP. Since SEP’s approximating factor f(θ) converges to the geometric average of the intermediate factors f̄(θ) ∝ [ ∏N n=1 fn(θ)] 1 N , SEP converges to the same fixed points as AEP if the learning rates satisfy the Robbins-Monro condition [22], and therefore under certain conditions [23], to the same fixed points as EP. But it is still an open question whether there are more direct relationships between EP and SEP."
    }, {
      "heading" : "4.2 Stochastic power EP: relationships to variational methods",
      "text" : "The relationship between variational inference and stochastic variational inference [3] mirrors the relationship between EP and SEP. Can these relationships be made more formal? If the moment projection step in EP is replaced by a natural parameter matching step then the resulting algorithm is equivalent to the Variational Message Passing (VMP) algorithm [24] (and see supplementary material). Moreover, VMP has the same fixed points as variational inference [13] (since minimising the local variational KL divergences is equivalent to minimising the global variational KL).\nThese results carry over to the new algorithms with minor modifications. Specifically VMP can be transformed into SVMP by replacing VMP’s local approximations with the global form employed by SEP. In the supplementary material we show that this algorithm is an instance of standard SVI and that it therefore has the same fixed points as VI when satisfies the Robbins-Monro condition [22]. More generally, the procedure can be applied any member of the power EP (PEP) [12] family of algorithms which replace the moment projection step in EP with alpha-divergence minimization\n[21], but care has to be taken when taking the limiting cases (see supplementary). These results lend weight to the view that SEP is a natural stochastic generalisation of EP."
    }, {
      "heading" : "4.3 Distributed SEP: controlling granularity of the approximation",
      "text" : "EP uses a fine-grained approximation comprising a single factor for each likelihood. SEP, on the other hand, uses a coarse-grained approximation comprising a signal global factor to approximate the average effect of all likelihood terms. One might worry that SEP’s approximation is too severe if the dataset contains sets of datapoints that have very different likelihood contributions (e.g. for odd-vs-even handwritten digits classification consider the affect of a 5 and a 9 on the posterior). It might be more sensible in such cases to partition the dataset into K disjoint pieces {Dk = {xn}Nkn=Nk−1} K k=1 with N = ∑K k=1Nk and use an approximating factor for each partition. If normal EP updates are performed on the subsets, i.e. treating p(Dk|θ) as a single true factor to be approximated, we arrive at the Distributed EP algorithm [5, 6]. But such updates are challenging as multiple likelihood terms must be included during each update necessitating additional approximations (e.g. MCMC). A simpler alternative uses SEP/AEP inside each partition, implying a posterior approximation of the form q(θ) ∝ p0(θ) ∏K k=1 fk(θ)\nNk with fk(θ)Nk approximating p(Dk|θ). The limiting cases of this algorithm, when K = 1 and K = N , recover SEP and EP respectively."
    }, {
      "heading" : "4.4 SEP with latent variables",
      "text" : "Many applications of EP involve latent variable models. Although this is not the main focus of the paper, we show that SEP is applicable in this case without scaling the memory footprint with N . Consider a model containing hidden variables, hn, associated with each observation p(xn,hn|θ) that are drawn i.i.d. from a prior p0(hn). The goal is to approximate the true posterior over parameters and hidden variables p(θ, {hn}|D) ∝ p0(θ) ∏ n p0(hn)p(xn|hn,θ). Typically, EP would approximate the effect of each intractable term as p(xn|hn,θ)p0(hn) ≈ fn(θ)gn(hn). Instead, SEP ties the approximate parameter factors p(xn|hn,θ)p0(hn) ≈ f(θ)gn(hn) yielding:\nq(θ, {hn}) 4∝ p0(θ)f(θ)N N∏ n=1 gn(hn). (2)\nCritically, as proved in supplementary, the local factors gn(hn) do not need to be maintained in memory. This means that all of the advantages of SEP carry over to more complex models involving latent variables, although this can potentially increase computation time in cases where updates for gn(hn) are not analytic, since then they will be initialised from scratch at each update."
    }, {
      "heading" : "5 Experiments",
      "text" : "The purpose of the experiments was to evaluate SEP on a number of datasets (synthetic and realworld, small and large) and on a number of models (probit regression, mixture of Gaussians and Bayesian neural networks)."
    }, {
      "heading" : "5.1 Bayesian probit regression",
      "text" : "The first experiments considered a simple Bayesian classification problem and investigated the stability and quality of SEP in relation to EP and ADF as well as the effect of using minibatches and varying the granularity of the approximation. The model comprised a probit likelihood function P (yn = 1|θ) = Φ(θTxn) and a Gaussian prior over the hyper-plane parameter p(θ) = N (θ;0, γI). The synthetic data comprised N = 5, 000 datapoints {(xn,yn)}, where xn were D = 4 dimensional and were either sampled from a single Gaussian distribution (Fig. 3(a)) or from a mixture of Gaussians (MoGs) with J = 5 components (Fig. 3(b)) to investigate the sensitivity of the methods to the homogeneity of the dataset. The labels were produced by sampling from the generative model. We followed [6] measuring the performance by computing an approximation of KL[p(θ|D)||q(θ)], where p(θ|D) was replaced by a Gaussian that had the same mean and covariance as samples drawn from the posterior using the No-U-Turn sampler (NUTS) [25], to quantify the calibration of uncertainty estimations.\nResults in Fig. 3(a) indicate that EP is the best performing method and that ADF collapses towards a delta function. SEP converges to a solution which appears to be of similar quality to that obtained by EP for the dataset containing Gaussian inputs, but slightly worse when the MoGs was used. Variants of SEP that used larger mini-batches fluctuated less, but typically took longer to converge (although for the small minibatches shown this effect is not clear). The utility of finer grained approximations depended on the homogeneity of the data. For the second dataset containing MoG inputs (shown in Fig. 3(b)), finer-grained approximations were found to be advantageous if the datapoints from each mixture component are assigned to the same approximating factor. Generally it was found that there is no advantage to retaining more approximating factors than there were clusters in the dataset.\nTo verify whether these conclusions about the granularity of the approximation hold in real datasets, we sampled N = 1, 000 datapoints for each of the digits in MNIST and performed odd-vs-even classification. Each digit class was assigned its own global approximating factor, K = 10. We compare the log-likelihood of a test set using ADF, SEP (K = 1), full EP and DSEP (K = 10) in Figure 3(c). EP and DSEP significantly outperform ADF. DSEP is slightly worse than full EP initially, however it reduces the memory to 0.001% of full EP without losing accuracy substantially. SEP’s accuracy was still increasing at the end of learning and was slightly better than ADF. Further empirical comparisons are reported in the supplementary, and in summary the three EP methods are indistinguishable when likelihood functions have similar contributions to the posterior.\nFinally, we tested SEP’s performance on six small binary classification datasets from the UCI machine learning repository.1 We did not consider the effect of mini-batches or the granularity of the approximation, using K = M = 1. We ran the tests with damping and stopped learning after convergence (by monitoring the updates of approximating factors). The classification results are summarised in Table 1. ADF performs reasonably well on the mean classification error metric, presumably because it tends to learn a good approximation to the posterior mode. However, the posterior variance is poorly approximated and therefore ADF returns poor test log-likelihood scores. EP achieves significantly higher test log-likelihood than ADF indicating that a superior approximation to the posterior variance is attained. Crucially, SEP performs very similarly to EP, implying that SEP is an accurate alternative to EP even though it is refining a cheaper global posterior approximation."
    }, {
      "heading" : "5.2 Mixture of Gaussians for clustering",
      "text" : "The small scale experiments on probit regression indicate that SEP performs well for fully-observed probabilistic models. Although it is not the main focus of the paper, we sought to test the flexibility of the method by applying it to a latent variable model, specifically a mixture of Gaussians. A synthetic MoGs dataset containing N = 200 datapoints was constructed comprising J = 4 Gaussians.\n1https://archive.ics.uci.edu/ml/index.html\nThe means were sampled from a Gaussian distribution, p(µj) = N (µ;m, I), the cluster identity variables were sampled from a uniform categorical distribution p(hn = j) = 1/4, and each mixture component was isotropic p(xn|hn) = N (xn;µhn , 0.52I). EP, ADF and SEP were performed to approximate the joint posterior over the cluster means {µj} and cluster identity variables {hn} (the other parameters were assumed known).\nFigure 4(a) visualises the approximate posteriors after 200 iterations. All methods return good estimates for the means, but ADF collapses towards a point estimate as expected. SEP, in contrast, captures the uncertainty and returns nearly identical approximations to EP. The accuracy of the methods is quantified in Fig. 4(b) by comparing the approximate posteriors to those obtained from NUTS. In this case the approximate KL-divergence measure is analytically intractable, instead we used the averaged F-norm of the difference of the Gaussian parameters fitted by NUTS and EP methods. These measures confirm that SEP approximates EP well in this case."
    }, {
      "heading" : "5.3 Probabilistic backpropagation",
      "text" : "The final set of tests consider more complicated models and large datasets. Specifically we evaluate the methods for probabilistic backpropagation (PBP) [4], a recent state-of-the-art method for scalable Bayesian learning in neural network models. Previous implementations of PBP perform several iterations of ADF over the training data. The moment matching operations required by ADF are themselves intractable and they are approximated by first propagating the uncertainty on the synaptic weights forward through the network in a sequential way, and then computing the gradient of the marginal likelihood by backpropagation. ADF is used to reduce the large memory cost that would be required by EP when the amount of available data is very large.\nWe performed several experiments to assess the accuracy of different implementations of PBP based on ADF, SEP and EP on regression datasets following the same experimental protocol as in [4] (see supplementary material). We considered neural networks with 50 hidden units (except for Year and Protein which we used 100). Table 2 shows the average test RMSE and test log-likelihood for each method. Interestingly, SEP can outperform EP in this setting (possibly because the stochasticity enabled it to find better solutions), and typically it performed similarly. Memory reductions using\nSEP instead of EP were large e.g. 694Mb for the Protein dataset and 65,107Mb for the Year dataset (see supplementary). Surprisingly ADF often outperformed EP, although the results presented for ADF use a near-optimal number of sweeps and further iterations generally degraded performance. ADF’s good performance is most likely due to an interaction with additional moment approximation required in PBP that is more accurate as the number of factors increases."
    }, {
      "heading" : "6 Conclusions and future work",
      "text" : "This paper has presented the stochastic expectation propagation method for reducing EP’s large memory consumption which is prohibitive for large datasets. We have connected the new algorithm to a number of existing methods including assumed density filtering, variational message passing, variational inference, stochastic variational inference and averaged EP. Experiments on Bayesian logistic regression (both synthetic and real world) and mixture of Gaussians clustering indicated that the new method had an accuracy that was competitive with EP. Experiments on the probabilistic back-propagation on large real world regression datasets again showed that SEP comparably to EP with a vastly reduced memory footprint. Future experimental work will focus on developing data-partitioning methods to leverage finer-grained approximations (DESP) that showed promising experimental performance and also mini-batch updates. There is also a need for further theoretical understanding of these algorithms, and indeed EP itself. Theoretical work will study the convergence properties of the new algorithms for which we only have limited results at present. Systematic comparisons of EP-like algorithms and variational methods will guide practitioners to choosing the appropriate scheme for their application."
    }, {
      "heading" : "Acknowledgements",
      "text" : "We thank the reviewers for valuable comments. YL thanks the Schlumberger Foundation Faculty for the Future fellowship on supporting her PhD study. JMHL acknowledges support from the Rafael del Pino Foundation. RET thanks EPSRC grant # EP/G050821/1 and EP/L000776/1."
    } ],
    "references" : [ {
      "title" : "Distributed stochastic gradient mcmc",
      "author" : [ "Sungjin Ahn", "Babak Shahbaba", "Max Welling" ],
      "venue" : "In Proceedings of the 31st International Conference on Machine Learning",
      "citeRegEx" : "1",
      "shortCiteRegEx" : "1",
      "year" : 2014
    }, {
      "title" : "Towards scaling up markov chain monte carlo: an adaptive subsampling approach",
      "author" : [ "Rémi Bardenet", "Arnaud Doucet", "Chris Holmes" ],
      "venue" : "In Proceedings of the 31st International Conference on Machine Learning",
      "citeRegEx" : "2",
      "shortCiteRegEx" : "2",
      "year" : 2014
    }, {
      "title" : "Stochastic variational inference",
      "author" : [ "Matthew D. Hoffman", "David M. Blei", "Chong Wang", "John William Paisley" ],
      "venue" : "Journal of Machine Learning Research,",
      "citeRegEx" : "3",
      "shortCiteRegEx" : "3",
      "year" : 2013
    }, {
      "title" : "Probabilistic backpropagation for scalable learning of bayesian neural networks",
      "author" : [ "José Miguel Hernández-Lobato", "Ryan P. Adams" ],
      "venue" : null,
      "citeRegEx" : "4",
      "shortCiteRegEx" : "4",
      "year" : 2015
    }, {
      "title" : "Expectation propagation as a way of life",
      "author" : [ "Andrew Gelman", "Aki Vehtari", "Pasi Jylnki", "Christian Robert", "Nicolas Chopin", "John P. Cunningham" ],
      "venue" : null,
      "citeRegEx" : "5",
      "shortCiteRegEx" : "5",
      "year" : 2014
    }, {
      "title" : "Distributed bayesian posterior sampling via moment sharing",
      "author" : [ "Minjie Xu", "Balaji Lakshminarayanan", "Yee Whye Teh", "Jun Zhu", "Bo Zhang" ],
      "venue" : "In NIPS,",
      "citeRegEx" : "6",
      "shortCiteRegEx" : "6",
      "year" : 2014
    }, {
      "title" : "Expectation propagation for approximate Bayesian inference",
      "author" : [ "Thomas P. Minka" ],
      "venue" : "In Uncertainty in Artificial Intelligence,",
      "citeRegEx" : "7",
      "shortCiteRegEx" : "7",
      "year" : 2001
    }, {
      "title" : "Expectation consistent approximate inference",
      "author" : [ "Manfred Opper", "Ole Winther" ],
      "venue" : "The Journal of Machine Learning Research,",
      "citeRegEx" : "8",
      "shortCiteRegEx" : "8",
      "year" : 2005
    }, {
      "title" : "Assessing approximate inference for binary gaussian process classification",
      "author" : [ "Malte Kuss", "Carl Edward Rasmussen" ],
      "venue" : "The Journal of Machine Learning Research,",
      "citeRegEx" : "9",
      "shortCiteRegEx" : "9",
      "year" : 2005
    }, {
      "title" : "Expectation propagation for likelihood-free inference",
      "author" : [ "Simon Barthelmé", "Nicolas Chopin" ],
      "venue" : "Journal of the American Statistical Association,",
      "citeRegEx" : "10",
      "shortCiteRegEx" : "10",
      "year" : 2014
    }, {
      "title" : "Gaussian probabilities and expectation propagation",
      "author" : [ "John P Cunningham", "Philipp Hennig", "Simon Lacoste-Julien" ],
      "venue" : "arXiv preprint arXiv:1111.6832,",
      "citeRegEx" : "11",
      "shortCiteRegEx" : "11",
      "year" : 2011
    }, {
      "title" : "Variational message passing",
      "author" : [ "John M Winn", "Christopher M Bishop" ],
      "venue" : "In Journal of Machine Learning Research,",
      "citeRegEx" : "13",
      "shortCiteRegEx" : "13",
      "year" : 2005
    }, {
      "title" : "An introduction to variational methods for graphical models",
      "author" : [ "Michael I Jordan", "Zoubin Ghahramani", "Tommi S Jaakkola", "Lawrence K Saul" ],
      "venue" : "Machine learning,",
      "citeRegEx" : "14",
      "shortCiteRegEx" : "14",
      "year" : 1999
    }, {
      "title" : "Variational algorithms for approximate Bayesian inference",
      "author" : [ "Matthew James Beal" ],
      "venue" : "PhD thesis, University of London,",
      "citeRegEx" : "15",
      "shortCiteRegEx" : "15",
      "year" : 2003
    }, {
      "title" : "Two problems with variational expectation maximisation for time-series models",
      "author" : [ "Richard E. Turner", "Maneesh Sahani" ],
      "venue" : "Bayesian Time series models,",
      "citeRegEx" : "16",
      "shortCiteRegEx" : "16",
      "year" : 2011
    }, {
      "title" : "Probabilistic amplitude and frequency demodulation",
      "author" : [ "Richard E. Turner", "Maneesh Sahani" ],
      "venue" : "Advances in Neural Information Processing Systems",
      "citeRegEx" : "17",
      "shortCiteRegEx" : "17",
      "year" : 2011
    }, {
      "title" : "Trueskill: A bayesian skill rating system",
      "author" : [ "Ralf Herbrich", "Tom Minka", "Thore Graepel" ],
      "venue" : "In Advances in Neural Information Processing Systems,",
      "citeRegEx" : "18",
      "shortCiteRegEx" : "18",
      "year" : 2006
    }, {
      "title" : "Stochastic models, estimation and control",
      "author" : [ "Peter S. Maybeck" ],
      "venue" : null,
      "citeRegEx" : "19",
      "shortCiteRegEx" : "19",
      "year" : 1982
    }, {
      "title" : "Sparse-posterior gaussian processes for general likelihoods",
      "author" : [ "Yuan Qi", "Ahmed H Abdel-Gawad", "Thomas P Minka" ],
      "venue" : "In Uncertainty and Artificial Intelligence (UAI),",
      "citeRegEx" : "20",
      "shortCiteRegEx" : "20",
      "year" : 2010
    }, {
      "title" : "Methods of information geometry, volume 191",
      "author" : [ "Shun-ichi Amari", "Hiroshi Nagaoka" ],
      "venue" : null,
      "citeRegEx" : "21",
      "shortCiteRegEx" : "21",
      "year" : 2000
    }, {
      "title" : "A stochastic approximation method",
      "author" : [ "Herbert Robbins", "Sutton Monro" ],
      "venue" : "The annals of mathematical statistics,",
      "citeRegEx" : "22",
      "shortCiteRegEx" : "22",
      "year" : 1951
    }, {
      "title" : "Expectation propagation in the large-data limit",
      "author" : [ "Guillaume Dehaene", "Simon Barthelmé" ],
      "venue" : null,
      "citeRegEx" : "23",
      "shortCiteRegEx" : "23",
      "year" : 2015
    }, {
      "title" : "Divergence measures and message passing",
      "author" : [ "Thomas Minka" ],
      "venue" : "Technical Report MSR-TR-2005-173, Microsoft Research,",
      "citeRegEx" : "24",
      "shortCiteRegEx" : "24",
      "year" : 2005
    }, {
      "title" : "The no-u-turn sampler: Adaptively setting path lengths in hamiltonian monte carlo",
      "author" : [ "Matthew D Hoffman", "Andrew Gelman" ],
      "venue" : "The Journal of Machine Learning Research,",
      "citeRegEx" : "25",
      "shortCiteRegEx" : "25",
      "year" : 2014
    } ],
    "referenceMentions" : [ {
      "referenceID" : 0,
      "context" : "Examples include sampling approximations [1, 2], distributional approximations including stochastic variational inference (SVI) [3] and assumed density filtering (ADF) [4], and approaches that mix distributional and sampling approximations [5, 6].",
      "startOffset" : 41,
      "endOffset" : 47
    }, {
      "referenceID" : 1,
      "context" : "Examples include sampling approximations [1, 2], distributional approximations including stochastic variational inference (SVI) [3] and assumed density filtering (ADF) [4], and approaches that mix distributional and sampling approximations [5, 6].",
      "startOffset" : 41,
      "endOffset" : 47
    }, {
      "referenceID" : 2,
      "context" : "Examples include sampling approximations [1, 2], distributional approximations including stochastic variational inference (SVI) [3] and assumed density filtering (ADF) [4], and approaches that mix distributional and sampling approximations [5, 6].",
      "startOffset" : 128,
      "endOffset" : 131
    }, {
      "referenceID" : 3,
      "context" : "Examples include sampling approximations [1, 2], distributional approximations including stochastic variational inference (SVI) [3] and assumed density filtering (ADF) [4], and approaches that mix distributional and sampling approximations [5, 6].",
      "startOffset" : 168,
      "endOffset" : 171
    }, {
      "referenceID" : 4,
      "context" : "Examples include sampling approximations [1, 2], distributional approximations including stochastic variational inference (SVI) [3] and assumed density filtering (ADF) [4], and approaches that mix distributional and sampling approximations [5, 6].",
      "startOffset" : 240,
      "endOffset" : 246
    }, {
      "referenceID" : 5,
      "context" : "Examples include sampling approximations [1, 2], distributional approximations including stochastic variational inference (SVI) [3] and assumed density filtering (ADF) [4], and approaches that mix distributional and sampling approximations [5, 6].",
      "startOffset" : 240,
      "endOffset" : 246
    }, {
      "referenceID" : 6,
      "context" : "One family of approximation method has garnered less attention in this regard: Expectation Propagation (EP) [7, 8].",
      "startOffset" : 108,
      "endOffset" : 114
    }, {
      "referenceID" : 7,
      "context" : "One family of approximation method has garnered less attention in this regard: Expectation Propagation (EP) [7, 8].",
      "startOffset" : 108,
      "endOffset" : 114
    }, {
      "referenceID" : 8,
      "context" : "At first sight, it therefore appears well suited to large-data problems: the locality of computation make the algorithm simple to parallelise and distribute, and good practical performance on a range of small data applications suggest that it will be accurate [9, 10, 11].",
      "startOffset" : 260,
      "endOffset" : 271
    }, {
      "referenceID" : 9,
      "context" : "At first sight, it therefore appears well suited to large-data problems: the locality of computation make the algorithm simple to parallelise and distribute, and good practical performance on a range of small data applications suggest that it will be accurate [9, 10, 11].",
      "startOffset" : 260,
      "endOffset" : 271
    }, {
      "referenceID" : 10,
      "context" : "At first sight, it therefore appears well suited to large-data problems: the locality of computation make the algorithm simple to parallelise and distribute, and good practical performance on a range of small data applications suggest that it will be accurate [9, 10, 11].",
      "startOffset" : 260,
      "endOffset" : 271
    }, {
      "referenceID" : 11,
      "context" : "The same pathology exists for the broader class of power EP (PEP) algorithms [12] that includes variational message passing [13].",
      "startOffset" : 124,
      "endOffset" : 128
    }, {
      "referenceID" : 12,
      "context" : "In contrast, variational inference (VI) methods [14, 15] utilise global approximations that are refined directly, which prevents memory overheads from scaling with N .",
      "startOffset" : 48,
      "endOffset" : 56
    }, {
      "referenceID" : 13,
      "context" : "In contrast, variational inference (VI) methods [14, 15] utilise global approximations that are refined directly, which prevents memory overheads from scaling with N .",
      "startOffset" : 48,
      "endOffset" : 56
    }, {
      "referenceID" : 14,
      "context" : "It is well known that variational free-energy approaches are biased and often severely so [16] and for particular models the variational free-energy objective is pathologically ill-suited such as those with non-smooth likelihood functions [11, 17].",
      "startOffset" : 90,
      "endOffset" : 94
    }, {
      "referenceID" : 10,
      "context" : "It is well known that variational free-energy approaches are biased and often severely so [16] and for particular models the variational free-energy objective is pathologically ill-suited such as those with non-smooth likelihood functions [11, 17].",
      "startOffset" : 239,
      "endOffset" : 247
    }, {
      "referenceID" : 15,
      "context" : "It is well known that variational free-energy approaches are biased and often severely so [16] and for particular models the variational free-energy objective is pathologically ill-suited such as those with non-smooth likelihood functions [11, 17].",
      "startOffset" : 239,
      "endOffset" : 247
    }, {
      "referenceID" : 17,
      "context" : "A second approach is to use ADF, a simple variant of EP that only requires a global approximation to be maintained in memory [19].",
      "startOffset" : 125,
      "endOffset" : 129
    }, {
      "referenceID" : 6,
      "context" : "ADF, however, provides poorly calibrated uncertainty estimates [7] which was one of the main motivating reasons for developing EP in the first place.",
      "startOffset" : 63,
      "endOffset" : 66
    }, {
      "referenceID" : 4,
      "context" : "Another idea uses EP to carve up the dataset [5, 6] using approximating factors for collections of datapoints.",
      "startOffset" : 45,
      "endOffset" : 51
    }, {
      "referenceID" : 5,
      "context" : "Another idea uses EP to carve up the dataset [5, 6] using approximating factors for collections of datapoints.",
      "startOffset" : 45,
      "endOffset" : 51
    }, {
      "referenceID" : 4,
      "context" : "(Indeed, the spirit of [5, 6] is to extend sampling methods to large datasets, not EP itself.",
      "startOffset" : 23,
      "endOffset" : 29
    }, {
      "referenceID" : 5,
      "context" : "(Indeed, the spirit of [5, 6] is to extend sampling methods to large datasets, not EP itself.",
      "startOffset" : 23,
      "endOffset" : 29
    }, {
      "referenceID" : 19,
      "context" : "If the approximating distribution is in the exponential family, as is often the case, then the KL minimisation reduces to a moment matching step [21] that we denote fn(θ) ← proj[p̃n(θ)]/q−n(θ).",
      "startOffset" : 145,
      "endOffset" : 149
    }, {
      "referenceID" : 20,
      "context" : "in the moment update, but other choices of may be more appropriate, including decreasing according to the Robbins-Monro condition [22].",
      "startOffset" : 130,
      "endOffset" : 134
    }, {
      "referenceID" : 21,
      "context" : "For M = N parallel SEP is equivalent to the so-called Averaged EP algorithm proposed in [23] as a theoretical tool to study the convergence properties of normal EP.",
      "startOffset" : 88,
      "endOffset" : 92
    }, {
      "referenceID" : 20,
      "context" : "Since SEP’s approximating factor f(θ) converges to the geometric average of the intermediate factors f̄(θ) ∝ [ ∏N n=1 fn(θ)] 1 N , SEP converges to the same fixed points as AEP if the learning rates satisfy the Robbins-Monro condition [22], and therefore under certain conditions [23], to the same fixed points as EP.",
      "startOffset" : 235,
      "endOffset" : 239
    }, {
      "referenceID" : 21,
      "context" : "Since SEP’s approximating factor f(θ) converges to the geometric average of the intermediate factors f̄(θ) ∝ [ ∏N n=1 fn(θ)] 1 N , SEP converges to the same fixed points as AEP if the learning rates satisfy the Robbins-Monro condition [22], and therefore under certain conditions [23], to the same fixed points as EP.",
      "startOffset" : 280,
      "endOffset" : 284
    }, {
      "referenceID" : 2,
      "context" : "The relationship between variational inference and stochastic variational inference [3] mirrors the relationship between EP and SEP.",
      "startOffset" : 84,
      "endOffset" : 87
    }, {
      "referenceID" : 22,
      "context" : "Can these relationships be made more formal? If the moment projection step in EP is replaced by a natural parameter matching step then the resulting algorithm is equivalent to the Variational Message Passing (VMP) algorithm [24] (and see supplementary material).",
      "startOffset" : 224,
      "endOffset" : 228
    }, {
      "referenceID" : 11,
      "context" : "Moreover, VMP has the same fixed points as variational inference [13] (since minimising the local variational KL divergences is equivalent to minimising the global variational KL).",
      "startOffset" : 65,
      "endOffset" : 69
    }, {
      "referenceID" : 20,
      "context" : "In the supplementary material we show that this algorithm is an instance of standard SVI and that it therefore has the same fixed points as VI when satisfies the Robbins-Monro condition [22].",
      "startOffset" : 186,
      "endOffset" : 190
    }, {
      "referenceID" : 19,
      "context" : "[21], but care has to be taken when taking the limiting cases (see supplementary).",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 4,
      "context" : "treating p(Dk|θ) as a single true factor to be approximated, we arrive at the Distributed EP algorithm [5, 6].",
      "startOffset" : 103,
      "endOffset" : 109
    }, {
      "referenceID" : 5,
      "context" : "treating p(Dk|θ) as a single true factor to be approximated, we arrive at the Distributed EP algorithm [5, 6].",
      "startOffset" : 103,
      "endOffset" : 109
    }, {
      "referenceID" : 5,
      "context" : "We followed [6] measuring the performance by computing an approximation of KL[p(θ|D)||q(θ)], where p(θ|D) was replaced by a Gaussian that had the same mean and covariance as samples drawn from the posterior using the No-U-Turn sampler (NUTS) [25], to quantify the calibration of uncertainty estimations.",
      "startOffset" : 12,
      "endOffset" : 15
    }, {
      "referenceID" : 23,
      "context" : "We followed [6] measuring the performance by computing an approximation of KL[p(θ|D)||q(θ)], where p(θ|D) was replaced by a Gaussian that had the same mean and covariance as samples drawn from the posterior using the No-U-Turn sampler (NUTS) [25], to quantify the calibration of uncertainty estimations.",
      "startOffset" : 242,
      "endOffset" : 246
    }, {
      "referenceID" : 3,
      "context" : "Specifically we evaluate the methods for probabilistic backpropagation (PBP) [4], a recent state-of-the-art method for scalable Bayesian learning in neural network models.",
      "startOffset" : 77,
      "endOffset" : 80
    }, {
      "referenceID" : 3,
      "context" : "We performed several experiments to assess the accuracy of different implementations of PBP based on ADF, SEP and EP on regression datasets following the same experimental protocol as in [4] (see supplementary material).",
      "startOffset" : 187,
      "endOffset" : 190
    } ],
    "year" : 2015,
    "abstractText" : "Expectation propagation (EP) is a deterministic approximation algorithm that is often used to perform approximate Bayesian parameter learning. EP approximates the full intractable posterior distribution through a set of local approximations that are iteratively refined for each datapoint. EP can offer analytic and computational advantages over other approximations, such as Variational Inference (VI), and is the method of choice for a number of models. The local nature of EP appears to make it an ideal candidate for performing Bayesian learning on large models in large-scale dataset settings. However, EP has a crucial limitation in this context: the number of approximating factors needs to increase with the number of datapoints, N , which often entails a prohibitively large memory overhead. This paper presents an extension to EP, called stochastic expectation propagation (SEP), that maintains a global posterior approximation (like VI) but updates it in a local way (like EP). Experiments on a number of canonical learning problems using synthetic and real-world datasets indicate that SEP performs almost as well as full EP, but reduces the memory consumption by a factor of N . SEP is therefore ideally suited to performing approximate Bayesian learning in the large model, large dataset setting.",
    "creator" : null
  }
}