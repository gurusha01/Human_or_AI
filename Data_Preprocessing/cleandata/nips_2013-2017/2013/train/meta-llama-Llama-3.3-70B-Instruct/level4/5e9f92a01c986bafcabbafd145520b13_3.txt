I have reevaluated the manuscript in light of the authors' rebuttal and removed my previous concern regarding point 3, as it has been adequately addressed. Although I still have some reservations about the responses to points 1 and 2, I have increased my score to 8.
The authors present a framework for two-photon imaging using compressed sensing, demonstrating its feasibility through simulations. They show that it is possible to estimate calcium traces, non-negative firing rates, and spatial intensity profiles of imaged neurons based on random projections of the data. Additionally, they derive an approximation to the phase transition curve, which is accurate under certain conditions.
I am generally supportive of this approach, as it has the potential to significantly improve the efficiency of two-photon imaging experiments, which often suffer from a trade-off between data quality and the number of neurons that can be imaged. While I am not able to verify the mathematical derivations, particularly in section 3, the successful verification through simulations suggests that they are correct.
However, I have some concerns that the authors have not convincingly demonstrated the practical feasibility and usefulness of their approach. Specifically, I have two main concerns:
1. The method's sensitivity to noise (Fig. 1) necessitates testing with realistic noise levels. In practice, noise levels in calcium imaging are high due to shot noise, particularly when imaging at high speeds. The authors should provide evidence that the signal-to-noise ratios (SNRs) used in their simulations are realistic, as my estimate would suggest that typical SNRs are closer to 0 dB than 20 dB.
2. The simulations assume a scenario where neurons are overlapping, but there is no background (neuropil) activity between them, and the neurons cover a major fraction of the imaged space. However, in real-world experiments, the situation is different, with cell bodies occupying at most 10% of the voxels and the remainder consisting of neuropil, which displays calcium activity. I am concerned that the algorithm (P-NN) may be affected by this, and the use of SVD to identify neurons assumes uncorrelated firing, which is unlikely to be true in most experiments. This could be a significant caveat, particularly since characterizing joint activity is a primary goal of imaging multiple neurons simultaneously.
While the approach is potentially interesting, the practical feasibility is still questionable and could be better addressed. If the goal of the paper is to lay out the basic mathematical framework, the authors should be more explicit about the potential practical problems that may arise. Currently, the manuscript implies that the method could be used to build an actual imaging setup, but it seems that we are still far from achieving that goal.