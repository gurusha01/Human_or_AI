This paper introduces a comprehensive modeling and inference framework that integrates the strengths of probabilistic graphical models with the adaptability of neural network models. The proposed approach, termed the structured variational autoencoder (SVAE), leverages graphical models to represent structured probability distributions while employing variational autoencoder techniques to learn the nonlinear data manifold. A key challenge in hybrid models is the difficulty of performing inference, which this paper addresses by proposing recognition networks that output conjugate graphical model potentials, enabling the use of tractable inference algorithms within graphical models. The authors present an algorithm for inference in the SVAE model and demonstrate its application on both synthetic and real datasets.
In the synthetic data experiment, the authors train a latent linear dynamical system (LDS) SVAE to predict the trajectory of a dot bouncing back and forth in a sequence of images. The model performs well on this relatively straightforward task. Subsequently, they apply an LDS SVAE to depth video recordings of mouse behavior, where the model appears to predict future frames effectively. Finally, they employ a latent switching linear dynamical system (SLDS) SVAE to identify discrete states corresponding to natural behavioral units. The integration of probabilistic graphical models and deep learning is a highly active and promising research area, and this paper makes a notable contribution by presenting a model capable of handling discrete latent variables. This capability opens up potential applications, such as the behavior representation modeling demonstrated in one of the experiments. 
The paper is well-organized and clearly written, though the technical content is dense. Algorithm 1 in Section 4 is particularly challenging to follow, with some symbols either undefined or difficult to locate. While the approach is commendably general, this generality may hinder the practical application of the algorithm to specific models. Including a detailed explanation of how the algorithm is applied to the examples in Figure 3, perhaps in an appendix, would be beneficial.
The primary limitation of the paper is the lack of comparisons to existing baselines, apart from the "toy" example in Figure 1. Although structured representations offer clear advantages, such as improved interpretability, it would have been helpful to compare the proposed method against baseline approaches. For instance, in Figure 5, it is difficult for readers unfamiliar with the dataset to assess the quality of the model's predictions without a point of reference. Additionally, Section 6.3 and Figure 6 require further elaboration. One of the more intriguing contributions of this work is the ability of the SLDS SVAE to uncover discrete latent behavioral states that influence observed dynamics. However, the presentation lacks sufficient detail. For example, while Section 6.3 mentions 30 discrete states, Figure 6 only illustrates two of them. It is unclear whether the remaining states are semantically meaningful or if the two shown were selected because they were the only significant ones. Providing more context and explanation would enhance the clarity and impact of this contribution.